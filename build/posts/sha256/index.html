<!DOCTYPE html>
<html lang="en">
	<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>KOTA YATAGAI | 八谷航太</title>
    <title>フルスクラッチでSHA-256を作る</title><meta name="description" content="TypeScriptで実装する" data-svelte="svelte-189on1m"><meta property="og:url" content="https://kota-yata.com" data-svelte="svelte-189on1m"><meta property="og:title" content="フルスクラッチでSHA-256を作る" data-svelte="svelte-189on1m"><meta property="og:image" content="https://kota-yata.com/media/sha256.webp" data-svelte="svelte-189on1m"><meta property="og:description" content="TypeScriptで実装する" data-svelte="svelte-189on1m"><meta name="twitter:card" content="summary_large_image" data-svelte="svelte-189on1m"><meta name="twitter:site" content="@kota_yata" data-svelte="svelte-189on1m">

		

		<link rel="modulepreload" href="/_app/start-daaae108.js">
		<link rel="modulepreload" href="/_app/chunks/vendor-495f2134.js">
		<link rel="modulepreload" href="/_app/pages/__layout.svelte-be316660.js">
		<link rel="modulepreload" href="/_app/chunks/index-6747d163.js">
		<link rel="modulepreload" href="/_app/pages/posts/_path_.svelte-2d94d26d.js">
		<link rel="modulepreload" href="/_app/chunks/page-7b278a70.js">
		<link rel="modulepreload" href="/_app/chunks/className-0b25377b.js">
		<link rel="stylesheet" href="/_app/assets/start-61d1577b.css">
		<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-0136ed43.css">
		<link rel="stylesheet" href="/_app/assets/app-d7359544.css">
		<link rel="stylesheet" href="/_app/assets/pages/posts/_path_.svelte-77f41461.css">
		<link rel="stylesheet" href="/_app/assets/page-da0bc829.css">

		<script type="module">
			import { start } from "/_app/start-daaae108.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":""},
				session: {},
				host: location.host,
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/_app/pages/__layout.svelte-be316660.js"),
						import("/_app/pages/posts/_path_.svelte-2d94d26d.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "\u002Fposts\u002Fsha256",
						query: new URLSearchParams(""),
						params: {path:"sha256"}
					}
				}
			});
		</script>
    <meta name="keyword" content="kota,yatagai,kota yatagai,八谷航太">
    <link rel="icon" href="/me.webp" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link defer
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
      rel="stylesheet">
    <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
      integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
    <link defer rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/a11y-dark.min.css"
      integrity="sha384-Mt8bPDNu0L2sVzon3+a8Rqtl4fmqaUmTPBEd/DTHiGFEQEFvf0fYLnU1DgK+ER2h" crossorigin="anonymous">
	</head>
	<body>
		<div id="svelte">


<header class="svelte-gbfwkw"><div class="left svelte-gbfwkw"><a href="/" class="svelte-gbfwkw">KOTA YATAGAI</a></div>
  <div class="right svelte-gbfwkw"><select name="language"><option value="JP">Japanese</option><option value="EN">English</option></select>
    <a href="/trip" sveltekit:prefetch class="svelte-gbfwkw"><img alt="to trip page" src="/airplane.svg" width="30px" height="30px"></a></div></header>

<main class="svelte-gbfwkw">
  

<div class="container svelte-izy1ym"><div class="profile svelte-izy1ym"><div class="container svelte-g32fgp"><img alt="myself" src="/me.webp" width="150px" height="150px" class="svelte-g32fgp">
  <div class="bio svelte-g32fgp"><h4 class="svelte-g32fgp">八谷航太</h4>
    <p class="svelte-g32fgp">18yo / ソフトウェア開発者</p></div>
  <ul class="svelte-g32fgp"><li class="svelte-g32fgp"><a href="/" class="svelte-g32fgp">Home</a></li><li class="svelte-g32fgp"><a href="/about" class="svelte-g32fgp">About</a></li><li class="svelte-g32fgp"><a href="/works" class="svelte-g32fgp">Works</a></li><li class="svelte-g32fgp"><a href="/contacts" class="svelte-g32fgp">Contacts</a></li></ul>
  <div class="icons svelte-g32fgp"><a href="https://github.com/kota-yata" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/github.svg" width="20px" height="20px"></a><a href="https://open.spotify.com/user/jgm80x9h1j84hnk4nv3hozlaf" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/spotify.svg" width="20px" height="20px"></a><a href="https://twitter.com/kota_yata" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/twitter.svg" width="20px" height="20px"></a><a href="https://speakerdeck.com/kota_yata/" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/speakerdeck.svg" width="20px" height="20px"></a></div>
</div></div>
  <div class="slot svelte-izy1ym"><div class="info svelte-hf3o4"><h1 class="info-title svelte-hf3o4">フルスクラッチでSHA-256を作る</h1>
    <span class="info-date svelte-hf3o4">2021-01-08</span>
    <span class="info-category algorithm svelte-hf3o4">Algorithm</span></div>
  <!-- HTML_TAG_START --><p>ハッシュ値の利用者として中身のアルゴリズムを知っておきたいと思ったのでTypeScriptで1からSHA-256を作ろうと思います。SHA-256は名前そのまま、どんな長さのメッセージでも256bitsのハッシュ値を返す関数です。</p>
<p>完成版はこちら<br>
<a href="https://github.com/kota-yata/organic-sha256">https://github.com/kota-yata/organic-sha256</a></p>
<div class="message">
この実装はのちに記載する仕様の論文に沿って純粋に記述しています。セキュリティ的にも速度的にも、プロジェクトでハッシュ関数を用いる際は既存のライブラリを使用することをおすすめします
</div>
<h2>前提知識</h2>
<p>論理演算（論理積とか論理和とか排他的論理和とか）とシフト演算が分かっていれば大体いけます。</p>
<p>論理積はAND。数式上では<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∧</mo></mrow><annotation encoding="application/x-tex">\land</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∧</span></span></span></span></eq>、コードでは<code>&amp;</code>で表します。<br>
論理和はOR。数式上では<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∨</mo></mrow><annotation encoding="application/x-tex">\lor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∨</span></span></span></span></eq>、コードでは<code>|</code>で表します。<br>
排他的論理和はXOR。数式上では$\oplus$、コードでは<code>^</code>で表します。</p>
<p>左シフト演算はビット列を左にnビット動かすやつです。値は<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></eq>倍になります。数式上では<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≪</mo></mrow><annotation encoding="application/x-tex">\ll</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">≪</span></span></span></span></eq>、コードでは<code>&lt;&lt;</code>で表します。<br>
右シフト演算はビット列を右にnビット動かすやつです。値は<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></eq>倍になります。数式上では<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≫</mo></mrow><annotation encoding="application/x-tex">\gg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">≫</span></span></span></span></eq>、コードでは符号なしの右シフト演算を使用するので<code>&gt;&gt;&gt;</code>で表します。</p>
<h2>下準備</h2>
<p>SHA256のハッシュ関数ではメッセージを512bitsのブロックに分けてハッシュ値を算出します。その際に余りや不足が出ては困るので、プリプロセスとして平文のPadding処理を行います。</p>
<h3>Padding関数</h3>
<p>このPadding処理ではメッセージを512bitsの倍数にして返します。実際の実装ではbyte単位で考えるので512bits = 64byte、64の倍数に拡張して返すという処理になります。</p>
<h5>手順</h5>
<p>具体的にはメッセージの末尾に<code>0x80(bit単位の1)</code>を加え、残りをメッセージのサイズを表すbyte列と0で埋めるという関数を書くことになります。メッセージサイズを表すbyte列は8bytesで、64bytesからその8bytesを引き、メッセージ分のbyteと<code>0x80</code>の1byteを引いた残りのbyteは0で埋めます。</p>
<h5>実装</h5>
<p>padding関数ではメッセージの文字列を引数にとって、64bytesの倍数にした16進数のbyte列を文字列の型で返すものです。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">sizeLastBlock</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">64</span>; <span class="hljs-comment">// Mの末尾のブロックサイズ</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">sizeMLengthBuffer</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">8</span>; <span class="hljs-comment">// 最終的なメッセージの末尾8bytesはMのサイズを記述する</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">sizeDivision</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// メッセージバイトと余りの0byteの区切り（0x80）</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">sizeMaxBlock</span>: <span class="hljs-built_in">number</span> = sizeLastBlock - sizeMLengthBuffer - sizeDivision; <span class="hljs-comment">// メッセージバイトは55bytes以下であれば良い</span>
</code></pre>
<p>ここは上で説明したサイズをbyteで表したものです。最後の<code>sizeMaxBlock</code>は、メッセージを入れられるbyte数を算出しています。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">sizeM</span>: <span class="hljs-built_in">number</span> = <span class="hljs-built_in">encodeURI</span>(M).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/%../g</span>, <span class="hljs-string">&quot;*&quot;</span>).<span class="hljs-property">length</span>;
</code></pre>
<p>ここではメッセージのbyte数を取得しています。<code>M.length</code>だと全角文字や絵文字の場合正確に取得できないため一度UTF-8でエンコードして長さを測ります。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">sizeLastM</span>: <span class="hljs-built_in">number</span> = sizeM % <span class="hljs-number">64</span>;
<span class="hljs-keyword">const</span> <span class="hljs-attr">isOverflow</span>: <span class="hljs-built_in">boolean</span> = sizeMaxBlock &lt; sizeLastM;

<span class="hljs-keyword">if</span> (isOverflow) sizeLastBlock = <span class="hljs-number">128</span>; <span class="hljs-comment">// Mの最後のブロックのバイトサイズが55bytesを超えていると1ブロックに格納できないため１ブロック追加する</span>
</code></pre>
<p>最後のブロックは末尾にメッセージサイズのバイトと区切りの<code>0x80</code>が入るので<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>64</mn><mo>−</mo><mn>8</mn><mo>−</mo><mn>1</mn><mo>=</mo><mn>55</mn></mrow><annotation encoding="application/x-tex">64-8-1=55</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">64</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">55</span></span></span></span></eq>bytesになります。なので64bytesに切り刻んだ最後のブロックが<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>55</mn><mo>&lt;</mo><mi>x</mi><mo>≤</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">55 &lt; x \le 64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">55</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">64</span></span></span></span></eq>bytesだった場合、もう一つブロックを増やす=最後のブロックを128bytesにしておく必要があります。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">hexStringM</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>((<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>()).<span class="hljs-title function_">encode</span>(M)).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> v.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);
</code></pre>
<p>文字列を16進数に変換しています。一回メッセージをUTF-8でエンコードし、それを一文字ずつ16進数文字列に変換しています。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">sizeExtra</span>: <span class="hljs-built_in">number</span> = (sizeLastBlock - sizeMLengthBuffer - sizeDivision - sizeLastM) * <span class="hljs-number">2</span>;
<span class="hljs-keyword">const</span> <span class="hljs-attr">hexExtraString</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>(sizeExtra).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);
</code></pre>
<p>0を入れる余りのbyte数を<code>sizeExtra</code>に代入し、<code>hexExtraString</code>に実際の文字列を入れています。<code>sizeExtra</code>の最後で2倍しているのは、のちに文字列を16進数の数値に変換した際に1文字の0だとその次の0と結合して16進数の<code>0x00</code>が生成されてしまうためです。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> hexSizeM : <span class="hljs-built_in">string</span>= (sizeM * <span class="hljs-number">8</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);
<span class="hljs-keyword">const</span> <span class="hljs-attr">hex8bytesLengthM</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>(<span class="hljs-number">16</span> - hexSizeM.<span class="hljs-property">length</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">concat</span>(hexSizeM).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);
</code></pre>
<p>メッセージの末尾に挿入するメッセージサイズの8bytesを生成しています。<code>hexSizeM</code>にサイズを表す16進数文字列を代入し、<code>hex8bytesLengthM</code>で8bytes内で使われなかったbytesに加える0と<code>hexSizeM</code>を結合しています。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">resultString</span>: <span class="hljs-built_in">string</span> = hexStringM + <span class="hljs-string">&quot;80&quot;</span> + hexExtraString + hex8bytesLengthM;
</code></pre>
<p>最終的に戻り値となる文字列を生成しています。</p>
<h3>Divide関数</h3>
<p>Padding処理によって64bytesの倍数になったメッセージを、64bytesごとに切り分けます。わざわざ関数に分けるほどでもありませんがPreprocessなので一応。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> divideM = (<span class="hljs-attr">M</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span>[] =&gt; {
  <span class="hljs-comment">// 文字列として扱っているので64bytesは128文字</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">arrayM</span>: <span class="hljs-title class_">RegExpMatchArray</span> | <span class="hljs-literal">null</span> = M.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/.{128}/g</span>);

  <span class="hljs-keyword">if</span> (!arrayM) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Failed to divide message&quot;</span>);

  <span class="hljs-keyword">return</span> arrayM;
};
</code></pre>
<h2>使用する関数を定義しちゃう</h2>
<p>下準備が終わったら、いよいよハッシュ値の算出に移ります。その際に繰り返し使用する関数をここで定義しておきます。</p>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext>ROTR</mtext><mi>n</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>≫</mo><mi>n</mi><mo stretchy="false">)</mo><mo>∨</mo><mo stretchy="false">(</mo><mi>x</mi><mo>≪</mo><mo stretchy="false">(</mo><mn>32</mn><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{ROTR}^{n}(x)=(x\gg n)\lor (x \ll (32 - n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7376em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">32</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext>SHR</mtext><mi>n</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>≫</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\text{SHR}^{n}(x)=x\gg n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">SHR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7376em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Ch</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>∧</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⊕</mo><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mi>x</mi><mo>∧</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Ch}(x,y,z) = (x \land y)\oplus(\lnot x \land z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Ch</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">¬</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Maj</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>∧</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⊕</mo><mo stretchy="false">(</mo><mi>x</mi><mo>∧</mo><mi>z</mi><mo stretchy="false">)</mo><mo>⊕</mo><mo stretchy="false">(</mo><mi>y</mi><mo>∧</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Maj}(x,y,z) = (x \land y)\oplus(x \land z)\oplus(y \land z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Maj</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="normal">Σ</mi><mn>0</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mtext>ROTR</mtext><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>ROTR</mtext><mn>13</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>ROTR</mtext><mn>22</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Sigma^{256}_0(x) = \text{ROTR}^{2}(x)\oplus\text{ROTR}^{13}(x)\oplus\text{ROTR}^{22}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="normal">Σ</mi><mn>1</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mtext>ROTR</mtext><mn>6</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>ROTR</mtext><mn>11</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>ROTR</mtext><mn>25</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Sigma^{256}_1(x) = \text{ROTR}^{6}(x)\oplus\text{ROTR}^{11}(x)\oplus\text{ROTR}^{25}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">25</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mn>0</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mtext>ROTR</mtext><mn>7</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>ROTR</mtext><mn>18</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>SHR</mtext><mn>3</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^{256}_0(x) = \text{ROTR}^{7}(x)\oplus\text{ROTR}^{18}(x)\oplus\text{SHR}^{3}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">18</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">SHR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mtext>ROTR</mtext><mn>17</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>ROTR</mtext><mn>19</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><msup><mtext>SHR</mtext><mn>10</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^{256}_1(x) = \text{ROTR}^{17}(x)\oplus\text{ROTR}^{19}(x)\oplus\text{SHR}^{10}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">17</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ROTR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">19</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">SHR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq></p>
<pre><code class="language-typescript"><span class="hljs-comment">// ROTR関数の定義</span>
<span class="hljs-keyword">const</span> rotr = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> ((x &gt;&gt;&gt; n) | (x &lt;&lt; (<span class="hljs-number">32</span> - n))) &gt;&gt;&gt; <span class="hljs-number">0</span>;
<span class="hljs-comment">// SHR関数の定義</span>
<span class="hljs-keyword">const</span> shr = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (x &gt;&gt;&gt; n) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> ch = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">z</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> ((x &amp; y) ^ (~x &amp; z)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> maj = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">z</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> upperSigma0 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">2</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">13</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">22</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> upperSigma1 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">6</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">11</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">25</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> lowerSigma0 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">7</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">18</span>) ^ <span class="hljs-title function_">shr</span>(x, <span class="hljs-number">3</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> lowerSigma1 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">17</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">19</span>) ^ <span class="hljs-title function_">shr</span>(x, <span class="hljs-number">10</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;
</code></pre>
<h2>定数を定義しちゃう</h2>
<p>ハッシュ値算出の際に使う定数も定義しておきましょう。といっても定数が64個入る配列を一つ作るだけです。<br>
配列の中身は、<strong>小さい方から64個の素数の立方根の小数点以下4bytes</strong>です。例えば配列のいちばん最初は最初の素数である2の立方根<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mroot><mn>2</mn><mn>3</mn></mroot><mo>=</mo><mn>1.2599210498</mn><mo>=</mo><mtext>1.428a2f986ed84</mtext><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\sqrt[3]{2}=1.2599210498=\text{1.428a2f986ed84}...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1328em;"></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7869em;"><span style="top:-2.9647em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.2599210498</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">1.428a2f986ed84</span></span><span class="mord">...</span></span></span></span></eq>の小数点以下4bytes<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>428a2f98</mtext></mrow><annotation encoding="application/x-tex">\text{428a2f98}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">428a2f98</span></span></span></span></span></eq>になります。なんでこんな値を取ってくるのでしょうか。僕にも分かりません。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">K</span>: <span class="hljs-built_in">number</span>[] = [
  <span class="hljs-number">0x428a2f98</span>, <span class="hljs-number">0x71374491</span>, <span class="hljs-number">0xb5c0fbcf</span>, <span class="hljs-number">0xe9b5dba5</span>, <span class="hljs-number">0x3956c25b</span>, <span class="hljs-number">0x59f111f1</span>, <span class="hljs-number">0x923f82a4</span>, <span class="hljs-number">0xab1c5ed5</span>, <span class="hljs-number">0xd807aa98</span>,
  <span class="hljs-number">0x12835b01</span>, <span class="hljs-number">0x243185be</span>, <span class="hljs-number">0x550c7dc3</span>, <span class="hljs-number">0x72be5d74</span>, <span class="hljs-number">0x80deb1fe</span>, <span class="hljs-number">0x9bdc06a7</span>, <span class="hljs-number">0xc19bf174</span>, <span class="hljs-number">0xe49b69c1</span>, <span class="hljs-number">0xefbe4786</span>,
  <span class="hljs-number">0x0fc19dc6</span>, <span class="hljs-number">0x240ca1cc</span>, <span class="hljs-number">0x2de92c6f</span>, <span class="hljs-number">0x4a7484aa</span>, <span class="hljs-number">0x5cb0a9dc</span>, <span class="hljs-number">0x76f988da</span>, <span class="hljs-number">0x983e5152</span>, <span class="hljs-number">0xa831c66d</span>, <span class="hljs-number">0xb00327c8</span>,
  <span class="hljs-number">0xbf597fc7</span>, <span class="hljs-number">0xc6e00bf3</span>, <span class="hljs-number">0xd5a79147</span>, <span class="hljs-number">0x06ca6351</span>, <span class="hljs-number">0x14292967</span>, <span class="hljs-number">0x27b70a85</span>, <span class="hljs-number">0x2e1b2138</span>, <span class="hljs-number">0x4d2c6dfc</span>, <span class="hljs-number">0x53380d13</span>,
  <span class="hljs-number">0x650a7354</span>, <span class="hljs-number">0x766a0abb</span>, <span class="hljs-number">0x81c2c92e</span>, <span class="hljs-number">0x92722c85</span>, <span class="hljs-number">0xa2bfe8a1</span>, <span class="hljs-number">0xa81a664b</span>, <span class="hljs-number">0xc24b8b70</span>, <span class="hljs-number">0xc76c51a3</span>, <span class="hljs-number">0xd192e819</span>,
  <span class="hljs-number">0xd6990624</span>, <span class="hljs-number">0xf40e3585</span>, <span class="hljs-number">0x106aa070</span>, <span class="hljs-number">0x19a4c116</span>, <span class="hljs-number">0x1e376c08</span>, <span class="hljs-number">0x2748774c</span>, <span class="hljs-number">0x34b0bcb5</span>, <span class="hljs-number">0x391c0cb3</span>, <span class="hljs-number">0x4ed8aa4a</span>,
  <span class="hljs-number">0x5b9cca4f</span>, <span class="hljs-number">0x682e6ff3</span>, <span class="hljs-number">0x748f82ee</span>, <span class="hljs-number">0x78a5636f</span>, <span class="hljs-number">0x84c87814</span>, <span class="hljs-number">0x8cc70208</span>, <span class="hljs-number">0x90befffa</span>, <span class="hljs-number">0xa4506ceb</span>, <span class="hljs-number">0xbef9a3f7</span>,
  <span class="hljs-number">0xc67178f2</span>
];
</code></pre>
<p>定数ですので実行するたびに「小さい方から64個の素数の立方根の小数点以下4byteを取ってきて配列に入れて…」とかやる必要はありません。</p>
<h2>ハッシュ値を算出していく</h2>
<p>いよいよ本題です。ハッシュ値の算出手順は、まず先ほど64bytesごとに切り分けたメッセージブロックをさらに4bytesのブロック、つまり半角文字1文字ずつに切り分けます。そしてそのWord一つ一つに対してローテーションという処理を行っていきます。</p>
<p>以降、足し算の際には、32bits符号なし整数型であることを保証するため必ず<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>0x100000000</mtext></mrow><annotation encoding="application/x-tex">\text{0x100000000}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord text"><span class="mord">0x100000000</span></span></span></span></span></eq>との剰余をとります。実装の際には<code>&amp; 0xffffffff</code>と論理積を使って剰余を擬似的に再現します。</p>
<h3>ハッシュ値を入れる配列を定義する</h3>
<p>まずはローテーション処理の肝となる配列を定義します</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">H</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0x6a09e667</span>, <span class="hljs-number">0xbb67ae85</span>, <span class="hljs-number">0x3c6ef372</span>, <span class="hljs-number">0xa54ff53a</span>, <span class="hljs-number">0x510e527f</span>, <span class="hljs-number">0x9b05688c</span>, <span class="hljs-number">0x1f83d9ab</span>, <span class="hljs-number">0x5be0cd19</span>];
</code></pre>
<p>これは後々ハッシュ値が格納され、ローテーション処理に使われる配列です。上の初期値は<strong>小さい方から8個の素数の平方根の小数点以下32bits</strong>です。先ほどの定数<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>K</mi><mn>63</mn></msub></mrow><annotation encoding="application/x-tex">K_{0},K_{1},K_{2}...K_{63}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">63</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>は立方根でしたが今回は平方根です。ほんとなんなんでしょうねこれ。</p>
<h3>ブロックをさらに切り分ける</h3>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">paddedString</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title function_">padding</span>(M);
<span class="hljs-keyword">const</span> <span class="hljs-attr">dividedM</span>: <span class="hljs-built_in">string</span>[] = <span class="hljs-title function_">divideM</span>(paddedString);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dividedM.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Mi</span>: <span class="hljs-title class_">RegExpMatchArray</span> | <span class="hljs-literal">null</span> = dividedM[i].<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/.{8}/g</span>); <span class="hljs-comment">// 64bytesのブロックをさらに4byteずつ刻んでいく</span>

    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Mi</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Failed to divide dividedM&quot;</span>);
    <span class="hljs-keyword">const</span> <span class="hljs-attr">W</span>: <span class="hljs-built_in">number</span>[] = <span class="hljs-title function_">mapW</span>(<span class="hljs-title class_">Array</span>(<span class="hljs-number">64</span>), <span class="hljs-title class_">Mi</span>);
    ...
</code></pre>
<p>先述の<code>divideM</code>関数で切り分けた64bytesのブロック一つ一つについて、<code>Mi</code>に4bytesづつ切り分けた変数を格納しています。ここで正規表現で8文字ずつ切り出しているのはPadding関数の時と同じく、後々数値に変換する際に2文字ごとに１６進数として読んでもらう必要があるからです。<br>
最後の<code>mapW</code>関数では<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></eq>という64個の要素を持つ配列を生成します。それでは<code>mapW</code>関数の中身をみてみましょう</p>
<h3>Wを作る</h3>
<p>ハッシュ値の算出に必要な<strong>メッセージスケジュール</strong>なるものを<code>mapW</code>関数で生成します。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> mapW = (<span class="hljs-attr">array64</span>: <span class="hljs-built_in">number</span>[], <span class="hljs-title class_">Mi</span>: <span class="hljs-built_in">string</span>[]): <span class="hljs-built_in">number</span>[] =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">hexNum</span>: <span class="hljs-built_in">number</span> = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Mi</span>[i], <span class="hljs-number">16</span>);

    <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">16</span>) {
      array64[i] = hexNum;
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">const</span> <span class="hljs-attr">tmp</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title function_">lowerSigma1</span>(array64[i - <span class="hljs-number">2</span>]) + array64[i - <span class="hljs-number">7</span>] + <span class="hljs-title function_">lowerSigma0</span>(array64[i - <span class="hljs-number">15</span>]) + array64[i - <span class="hljs-number">16</span>];

    array64[i] = (tmp &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">return</span> array64;
};
</code></pre>
<p>第一引数には64個の空要素を持つ配列、第二引数にはブロックを4bytesに切り刻んだ配列をとります。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">hexNum</span>: <span class="hljs-built_in">number</span> = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Mi</span>[i], <span class="hljs-number">16</span>);
</code></pre>
<p>この数値化部分で、これまで0をbyte×2個生成したりbyte×2文字でブロックを切り分けたりしていたことが生きてきます。そうやって半ば強引に生成した擬似的な16進数文字列のおかげで論理演算やシフト演算が円滑に行えるのです。</p>
<pre><code>if (i &lt; 16) {
  array64[i] = hexNum;
  continue;
}
</code></pre>
<p><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></eq>の1~16番目には数値化したメッセージブロック4bytesを格納します。<br>
それ以降のインデックスには以下の式で算出した値を格納します。<br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>t</mi></msub><mo>=</mo><msubsup><mi>σ</mi><mn>1</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>W</mi><mrow><mi>t</mi><mo>−</mo><mn>7</mn></mrow></msub><mo>+</mo><msubsup><mi>σ</mi><mn>0</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mi>t</mi><mo>−</mo><mn>15</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>W</mi><mrow><mi>t</mi><mo>−</mo><mn>16</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{t}=\sigma^{256}_1(W_{t-2})+W_{t-7}+\sigma^{256}_0(W_{t-15})+W_{t-16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">15</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">16</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></eq><br>
かなりややこしいですが先ほど定義しておいた関数に当てはめるだけなので実装自体は単純です。</p>
<pre><code class="language-typescript">  <span class="hljs-keyword">const</span> <span class="hljs-attr">tmp</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title function_">lowerSigma1</span>(array64[i - <span class="hljs-number">2</span>]) + array64[i - <span class="hljs-number">7</span>] + <span class="hljs-title function_">lowerSigma0</span>(array64[i - <span class="hljs-number">15</span>]) + array64[i - <span class="hljs-number">16</span>];

  array64[i] = (tmp &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
}
  <span class="hljs-keyword">return</span> array64; <span class="hljs-comment">// Wを返してmapW関数は終了</span>
</code></pre>
<p>途中の<code>(tmp &amp; 0xffffffff) &gt;&gt;&gt; 0</code>の最後の符号なし右シフトは何をしているのかというと、tmpの値と<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>0xffffffff</mtext></mrow><annotation encoding="application/x-tex">\text{0xffffffff}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">0xffffffff</span></span></span></span></span></eq>の剰余を強制的に符号なし、つまりプラスの値に変換しているのです。他の言語であればこんなことしなくても符号なしの演算はできるのですが、<strong>JavaScriptはこの符号なし右シフト以外で確実に非負の数であると保証する方法はありません。</strong><code>(tmp &amp; 0xffffffff)</code>がすでに非負だった場合この演算は無意味ですが、負の数だった場合はこのめんどい作業が必要になります。</p>
<h3>前のブロックで生成されたハッシュ値を変数に代入する</h3>
<p>メインのハッシュ値算出関数に戻ります。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">let</span> a, b, c, d, e, f, g, h;

[a, b, c, d, e, f, g, h] = [...H];
</code></pre>
<p>ここで変数a~hにブロックごとのループの最後で生成されるハッシュ値、つまり一つ前のブロックのハッシュ値を代入していきます。</p>
<h3>Wを使ったローテーション</h3>
<p>先ほど<code>mapW</code>関数で生成したW配列をイテレートして上の変数a~hの値をローテーションしていきます。<br>
イテレートが始まったら、最初に一時的に値を保管す変数<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>と<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>を定義します。<br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><mtext>h</mtext><mo>+</mo><msubsup><mi mathvariant="normal">Σ</mi><mn>1</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo><mo>+</mo><mtext>Ch</mtext><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><mi>f</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>K</mi><mi>t</mi></msub><mo>+</mo><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">T_{1}=\text{h}+\Sigma^{256}_{1}(e)+\text{Ch}(e,f,g)+K_{t}+W_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">h</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Ch</span></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq><br>
<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi mathvariant="normal">Σ</mi><mn>0</mn><mn>256</mn></msubsup><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mtext>Maj</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_{2}=\Sigma^{256}_{0}(a)+\text{Maj}(a,b,c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Maj</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></eq></p>
<pre><code class="language-typescript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> t = <span class="hljs-number">0</span>; t &lt; <span class="hljs-number">64</span>; t++) {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">T1</span>: <span class="hljs-built_in">number</span> = ((h + <span class="hljs-title function_">upperSigma1</span>(e) + <span class="hljs-title function_">ch</span>(e, f, g) + K[t] + W[t]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">T2</span>: <span class="hljs-built_in">number</span> = ((<span class="hljs-title function_">upperSigma0</span>(a) + <span class="hljs-title function_">maj</span>(a, b, c)) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;

  h = g;
  g = f;
  f = e;
  e = ((d + <span class="hljs-variable constant_">T1</span>) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  d = c;
  c = b;
  b = a;
  a = ((<span class="hljs-variable constant_">T1</span> + <span class="hljs-variable constant_">T2</span>) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
}
</code></pre>
<p>eとa以外はひとつ前のアルファベットの値が代入されるだけで、eは<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>+</mo><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">d+T_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>、aは<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>+</mo><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_{1}+T_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>になります。これをW内の要素全て、つまり64回分行います。<br>
メッセージをabcとしてこのローテーション処理を行った際のa~hの変化が以下です</p>
<pre><code>5d6aebcd 6a09e667 bb67ae85 3c6ef372 fa2a4622 510e527f 9b05688c 1f83d9ab
5a6ad9ad 5d6aebcd 6a09e667 bb67ae85 78ce7989 fa2a4622 510e527f 9b05688c
c8c347a7 5a6ad9ad 5d6aebcd 6a09e667 f92939eb 78ce7989 fa2a4622 510e527f
d550f666 c8c347a7 5a6ad9ad 5d6aebcd 24e00850 f92939eb 78ce7989 fa2a4622
4409a6a d550f666 c8c347a7 5a6ad9ad 43ada245 24e00850 f92939eb 78ce7989
2b4209f5 4409a6a d550f666 c8c347a7 714260ad 43ada245 24e00850 f92939eb
e5030380 2b4209f5 4409a6a d550f666 9b27a401 714260ad 43ada245 24e00850
85a07b5f e5030380 2b4209f5 4409a6a c657a79 9b27a401 714260ad 43ada245
8e04ecb9 85a07b5f e5030380 2b4209f5 32ca2d8c c657a79 9b27a401 714260ad
8c87346b 8e04ecb9 85a07b5f e5030380 1cc92596 32ca2d8c c657a79 9b27a401
4798a3f4 8c87346b 8e04ecb9 85a07b5f 436b23e8 1cc92596 32ca2d8c c657a79
f71fc5a9 4798a3f4 8c87346b 8e04ecb9 816fd6e9 436b23e8 1cc92596 32ca2d8c
87912990 f71fc5a9 4798a3f4 8c87346b 1e578218 816fd6e9 436b23e8 1cc92596
d932eb16 87912990 f71fc5a9 4798a3f4 745a48de 1e578218 816fd6e9 436b23e8
続く...
</code></pre>
<p>斜めに値がローテーションし、一番左と左から5行目、つまりaとeで毎度値が変わっているのが分かるはずです。</p>
<h3>前のハッシュ値とa~hを足す</h3>
<pre><code class="language-typescript">  H[<span class="hljs-number">0</span>] = ((a + H[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">1</span>] = ((b + H[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">2</span>] = ((c + H[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">3</span>] = ((d + H[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">4</span>] = ((e + H[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">5</span>] = ((f + H[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">6</span>] = ((g + H[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  H[<span class="hljs-number">7</span>] = ((h + H[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
}<span class="hljs-comment">// ↖︎次のブロックへ</span>
</code></pre>
<p>前のブロックのハッシュ値とa~hの値を加算し、このブロックのハッシュ値が完成します。</p>
<h2>ハッシュ値をハッシュ値にする</h2>
<p>以上の流れをブロック数回行うと、最後のHには一方向性と耐衝突性を持つハッシュ値が格納された状態になります。しかしこのままでは配列なので、それを結合して文字列の形に直します。<br>
配列を結合するだけなら簡単なのですが、ここでも少し罠があったので紹介します。</p>
<pre><code class="language-typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;&quot;</span>;

H.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">b</span> =&gt;</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">hashString</span>: <span class="hljs-built_in">string</span> = b.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);
  <span class="hljs-keyword">if</span>(hashString.<span class="hljs-property">length</span> &lt; <span class="hljs-number">8</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">extraZeros</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>(<span class="hljs-number">8</span> - hashString.<span class="hljs-property">length</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);
    hashString = extraZeros + hashString;
  }
  result += hashString;
});
<span class="hljs-keyword">if</span>(result.<span class="hljs-property">length</span> !== <span class="hljs-number">64</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Hash result is not 32bytes&quot;</span>);

<span class="hljs-keyword">return</span> result; <span class="hljs-comment">// SHA-256完成！</span>
</code></pre>
<p>真ん中のHをイテレートしている部分は何をやっているのかというと、配列の要素ひとつひとつの文字数を測り、8文字に満たない場合はその分0を先頭に追加しています。これは、<code>hashString</code>で数値を文字列に変換した際に、先頭に0があるとそれは省略されて文字列化されてしまうのです。そうすると結果が256bitsでなくなってしまうので、無理矢理ではありますが省略分の0を加える必要があるのです。</p>
<h2>ソースコード</h2>
<p>だいぶ細々と説明をしてきたので、最後に全体のソースコードを貼っておきます。これは一番上で貼ったリポジトリでも見ることができます。</p>
<pre><code class="language-typescript"><span class="hljs-comment">// 文字列を引数にとり、64の倍数bytesのHex文字列を返す</span>
<span class="hljs-keyword">const</span> padding = (<span class="hljs-attr">M</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">sizeLastBlock</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">64</span>; <span class="hljs-comment">// Mの末尾のブロックサイズ</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeMLengthBuffer</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">8</span>; <span class="hljs-comment">// 最終的なメッセージの末尾8bytesはMのサイズを記述する</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeDivision</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// メッセージバイトと余りの0バイトの区切り（0x80）</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeMaxBlock</span>: <span class="hljs-built_in">number</span> = sizeLastBlock - sizeMLengthBuffer - sizeDivision; <span class="hljs-comment">// メッセージバイトは55bytes以下であれば良い</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeM</span>: <span class="hljs-built_in">number</span> = <span class="hljs-built_in">encodeURI</span>(M).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/%../g</span>, <span class="hljs-string">&quot;*&quot;</span>).<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeLastM</span>: <span class="hljs-built_in">number</span> = sizeM % <span class="hljs-number">64</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">isOverflow</span>: <span class="hljs-built_in">boolean</span> = sizeMaxBlock &lt; sizeLastM;

  <span class="hljs-keyword">if</span> (isOverflow) sizeLastBlock = <span class="hljs-number">128</span>; <span class="hljs-comment">// Mの最後のブロックのバイトサイズが55bytesを超えていると1ブロックに格納できないため１ブロック追加する</span>
  <span class="hljs-comment">// Mを16進数文字列に変換</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">hexStringM</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>((<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>()).<span class="hljs-title function_">encode</span>(M)).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> v.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);
  <span class="hljs-comment">// 余りの0の配列を生成</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeExtra</span>: <span class="hljs-built_in">number</span> = (sizeLastBlock - sizeMLengthBuffer - sizeDivision - sizeLastM) * <span class="hljs-number">2</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">hexExtraString</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>(sizeExtra).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);
  <span class="hljs-comment">// Mのサイズを8bytesで表現する</span>
  <span class="hljs-keyword">const</span> hexSizeM : <span class="hljs-built_in">string</span>= (sizeM * <span class="hljs-number">8</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-attr">hex8bytesLengthM</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>(<span class="hljs-number">16</span> - hexSizeM.<span class="hljs-property">length</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">concat</span>(hexSizeM).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>);
  <span class="hljs-comment">// 64bytesの倍数になったPaddedStringを生成</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">resultString</span>: <span class="hljs-built_in">string</span> = hexStringM + <span class="hljs-string">&quot;80&quot;</span> + hexExtraString + hex8bytesLengthM;

  <span class="hljs-keyword">return</span> resultString;
};

<span class="hljs-comment">// 64の倍数bytesのHex文字列を引数にとり、64bytesごとに切り分けた配列を返す</span>
<span class="hljs-keyword">const</span> divideM = (<span class="hljs-attr">M</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span>[] =&gt; {
  <span class="hljs-comment">// 文字列として扱っているので64bytesは128文字</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">arrayM</span>: <span class="hljs-title class_">RegExpMatchArray</span> | <span class="hljs-literal">null</span> = M.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/.{128}/g</span>);

  <span class="hljs-keyword">if</span> (!arrayM) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Failed to divide message&quot;</span>);

  <span class="hljs-keyword">return</span> arrayM;
};

<span class="hljs-keyword">const</span> ch = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">z</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> ((x &amp; y) ^ (~x &amp; z)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> maj = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">z</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> rotr = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> ((x &gt;&gt;&gt; n) | (x &lt;&lt; (<span class="hljs-number">32</span> - n))) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> shr = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (x &gt;&gt;&gt; n) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> upperSigma0 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">2</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">13</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">22</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> upperSigma1 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">6</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">11</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">25</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> lowerSigma0 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">7</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">18</span>) ^ <span class="hljs-title function_">shr</span>(x, <span class="hljs-number">3</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-keyword">const</span> lowerSigma1 = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> (<span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">17</span>) ^ <span class="hljs-title function_">rotr</span>(x, <span class="hljs-number">19</span>) ^ <span class="hljs-title function_">shr</span>(x, <span class="hljs-number">10</span>)) &gt;&gt;&gt; <span class="hljs-number">0</span>;

<span class="hljs-comment">// 小さい方から64個の素数の立方根の小数点以下4bytesの定数</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">K</span>: <span class="hljs-built_in">number</span>[] = [
  <span class="hljs-number">0x428a2f98</span>, <span class="hljs-number">0x71374491</span>, <span class="hljs-number">0xb5c0fbcf</span>, <span class="hljs-number">0xe9b5dba5</span>, <span class="hljs-number">0x3956c25b</span>, <span class="hljs-number">0x59f111f1</span>, <span class="hljs-number">0x923f82a4</span>, <span class="hljs-number">0xab1c5ed5</span>, <span class="hljs-number">0xd807aa98</span>,
  <span class="hljs-number">0x12835b01</span>, <span class="hljs-number">0x243185be</span>, <span class="hljs-number">0x550c7dc3</span>, <span class="hljs-number">0x72be5d74</span>, <span class="hljs-number">0x80deb1fe</span>, <span class="hljs-number">0x9bdc06a7</span>, <span class="hljs-number">0xc19bf174</span>, <span class="hljs-number">0xe49b69c1</span>, <span class="hljs-number">0xefbe4786</span>,
  <span class="hljs-number">0x0fc19dc6</span>, <span class="hljs-number">0x240ca1cc</span>, <span class="hljs-number">0x2de92c6f</span>, <span class="hljs-number">0x4a7484aa</span>, <span class="hljs-number">0x5cb0a9dc</span>, <span class="hljs-number">0x76f988da</span>, <span class="hljs-number">0x983e5152</span>, <span class="hljs-number">0xa831c66d</span>, <span class="hljs-number">0xb00327c8</span>,
  <span class="hljs-number">0xbf597fc7</span>, <span class="hljs-number">0xc6e00bf3</span>, <span class="hljs-number">0xd5a79147</span>, <span class="hljs-number">0x06ca6351</span>, <span class="hljs-number">0x14292967</span>, <span class="hljs-number">0x27b70a85</span>, <span class="hljs-number">0x2e1b2138</span>, <span class="hljs-number">0x4d2c6dfc</span>, <span class="hljs-number">0x53380d13</span>,
  <span class="hljs-number">0x650a7354</span>, <span class="hljs-number">0x766a0abb</span>, <span class="hljs-number">0x81c2c92e</span>, <span class="hljs-number">0x92722c85</span>, <span class="hljs-number">0xa2bfe8a1</span>, <span class="hljs-number">0xa81a664b</span>, <span class="hljs-number">0xc24b8b70</span>, <span class="hljs-number">0xc76c51a3</span>, <span class="hljs-number">0xd192e819</span>,
  <span class="hljs-number">0xd6990624</span>, <span class="hljs-number">0xf40e3585</span>, <span class="hljs-number">0x106aa070</span>, <span class="hljs-number">0x19a4c116</span>, <span class="hljs-number">0x1e376c08</span>, <span class="hljs-number">0x2748774c</span>, <span class="hljs-number">0x34b0bcb5</span>, <span class="hljs-number">0x391c0cb3</span>, <span class="hljs-number">0x4ed8aa4a</span>,
  <span class="hljs-number">0x5b9cca4f</span>, <span class="hljs-number">0x682e6ff3</span>, <span class="hljs-number">0x748f82ee</span>, <span class="hljs-number">0x78a5636f</span>, <span class="hljs-number">0x84c87814</span>, <span class="hljs-number">0x8cc70208</span>, <span class="hljs-number">0x90befffa</span>, <span class="hljs-number">0xa4506ceb</span>, <span class="hljs-number">0xbef9a3f7</span>,
  <span class="hljs-number">0xc67178f2</span>
];

<span class="hljs-keyword">const</span> mapW = (<span class="hljs-attr">array64</span>: <span class="hljs-built_in">number</span>[], <span class="hljs-title class_">Mi</span>: <span class="hljs-built_in">string</span>[]): <span class="hljs-built_in">number</span>[] =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">hexNum</span>: <span class="hljs-built_in">number</span> = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Mi</span>[i], <span class="hljs-number">16</span>);

    <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">16</span>) {
      array64[i] = hexNum;
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">const</span> <span class="hljs-attr">tmp</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title function_">lowerSigma1</span>(array64[i - <span class="hljs-number">2</span>]) + array64[i - <span class="hljs-number">7</span>] + <span class="hljs-title function_">lowerSigma0</span>(array64[i - <span class="hljs-number">15</span>]) + array64[i - <span class="hljs-number">16</span>];

    array64[i] = (tmp &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  }
  <span class="hljs-keyword">return</span> array64;
};

<span class="hljs-comment">// メインの関数</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> computeHash = (<span class="hljs-attr">M</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
  <span class="hljs-comment">// ブロックごとにハッシュ値が格納される配列</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">H</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0x6a09e667</span>, <span class="hljs-number">0xbb67ae85</span>, <span class="hljs-number">0x3c6ef372</span>, <span class="hljs-number">0xa54ff53a</span>, <span class="hljs-number">0x510e527f</span>, <span class="hljs-number">0x9b05688c</span>, <span class="hljs-number">0x1f83d9ab</span>, <span class="hljs-number">0x5be0cd19</span>];
  <span class="hljs-keyword">const</span> <span class="hljs-attr">paddedString</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title function_">padding</span>(M);
  <span class="hljs-keyword">const</span> <span class="hljs-attr">dividedM</span>: <span class="hljs-built_in">string</span>[] = <span class="hljs-title function_">divideM</span>(paddedString);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dividedM.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Mi</span>: <span class="hljs-title class_">RegExpMatchArray</span> | <span class="hljs-literal">null</span> = dividedM[i].<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/.{8}/g</span>); <span class="hljs-comment">// 64bytesのブロックをさらに4byteずつ刻んでいく</span>

    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Mi</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Failed to divide dividedM&quot;</span>);
    <span class="hljs-keyword">const</span> <span class="hljs-attr">W</span>: <span class="hljs-built_in">number</span>[] = <span class="hljs-title function_">mapW</span>(<span class="hljs-title class_">Array</span>(<span class="hljs-number">64</span>), <span class="hljs-title class_">Mi</span>);
    <span class="hljs-keyword">let</span> a, b, c, d, e, f, g, h;

    [a, b, c, d, e, f, g, h] = [...H];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> t = <span class="hljs-number">0</span>; t &lt; <span class="hljs-number">64</span>; t++) {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">T1</span>: <span class="hljs-built_in">number</span> = ((h + <span class="hljs-title function_">upperSigma1</span>(e) + <span class="hljs-title function_">ch</span>(e, f, g) + K[t] + W[t]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
      <span class="hljs-keyword">const</span> <span class="hljs-attr">T2</span>: <span class="hljs-built_in">number</span> = ((<span class="hljs-title function_">upperSigma0</span>(a) + <span class="hljs-title function_">maj</span>(a, b, c)) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;

      h = g;
      g = f;
      f = e;
      e = ((d + <span class="hljs-variable constant_">T1</span>) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
      d = c;
      c = b;
      b = a;
      a = ((<span class="hljs-variable constant_">T1</span> + <span class="hljs-variable constant_">T2</span>) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    }
    H[<span class="hljs-number">0</span>] = ((a + H[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">1</span>] = ((b + H[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">2</span>] = ((c + H[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">3</span>] = ((d + H[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">4</span>] = ((e + H[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">5</span>] = ((f + H[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">6</span>] = ((g + H[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
    H[<span class="hljs-number">7</span>] = ((h + H[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffffffff</span>) &gt;&gt;&gt; <span class="hljs-number">0</span>;
  }

  <span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;&quot;</span>;

  H.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">b</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-attr">hashString</span>: <span class="hljs-built_in">string</span> = b.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);
    <span class="hljs-keyword">if</span>(hashString.<span class="hljs-property">length</span> &lt; <span class="hljs-number">8</span>) {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">extraZeros</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Array</span>(<span class="hljs-number">8</span> - hashString.<span class="hljs-property">length</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);
      hashString = extraZeros + hashString;
    }
    result += hashString;
  });
  <span class="hljs-keyword">if</span>(result.<span class="hljs-property">length</span> !== <span class="hljs-number">64</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Hash result is not 32bytes&quot;</span>);

  <span class="hljs-keyword">return</span> result;
};
</code></pre>
<p>最適化とは程遠いコードですが、ひとつアルゴリズムを理解できたというのは嬉しいですね。</p>
<h2>参考文献</h2>
<p><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a></p>
<p><a href="https://qiita.com/tnakagawa/items/6321472098a2b73836ab#sha256%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E8%A8%88%E7%AE%97sha-256-hash-computation">https://qiita.com/tnakagawa/items/6321472098a2b73836ab#sha256ハッシュ計算sha-256-hash-computation</a></p>
<p><a href="https://www.air-h.jp/articles/emopro/%E3%80%90go%E3%80%91%E6%9A%97%E5%8F%B7%E5%8C%96%E3%82%84%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E8%80%83%E3%81%88%E3%82%8B%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB/">https://www.air-h.jp/articles/emopro/【go】暗号化やハッシュ化について考えるついでに/</a></p>
<!-- HTML_TAG_END -->
  <div class="share svelte-hf3o4"><a class="share-twitter svelte-hf3o4" target="blank"><img alt="Twitter share button" src="/twitter.svg" width="25px" height="25px"></a>
    <a class="share-pocket svelte-hf3o4" target="blank"><img alt="Pocket share button" src="/pocket.svg" width="25px" height="25px"></a>
    <a class="share-instapaper svelte-hf3o4" target="blank"><img alt="InstaPaper share button" src="/instapaper.svg" width="25px"></a></div></div>
</div></main>

<footer class="svelte-gbfwkw">@ 2021 Kota Yatagai</footer>



			<script type="application/json" data-type="svelte-data" data-url="/posts/sha256.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"meta\":{\"title\":\"フルスクラッチでSHA-256を作る\",\"date\":\"2021-01-08\",\"category\":\"Algorithm\",\"description\":\"TypeScriptで実装する\",\"ogp\":\"\u002Fmedia\u002Fsha256.webp\"},\"body\":\"\u003Cp\u003Eハッシュ値の利用者として中身のアルゴリズムを知っておきたいと思ったのでTypeScriptで1からSHA-256を作ろうと思います。SHA-256は名前そのまま、どんな長さのメッセージでも256bitsのハッシュ値を返す関数です。\u003C\u002Fp\u003E\\n\u003Cp\u003E完成版はこちら\u003Cbr\u003E\\n\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fkota-yata\u002Forganic-sha256\\\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fkota-yata\u002Forganic-sha256\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cdiv class=\\\"message\\\"\u003E\\nこの実装はのちに記載する仕様の論文に沿って純粋に記述しています。セキュリティ的にも速度的にも、プロジェクトでハッシュ関数を用いる際は既存のライブラリを使用することをおすすめします\\n\u003C\u002Fdiv\u003E\\n\u003Ch2\u003E前提知識\u003C\u002Fh2\u003E\\n\u003Cp\u003E論理演算（論理積とか論理和とか排他的論理和とか）とシフト演算が分かっていれば大体いけます。\u003C\u002Fp\u003E\\n\u003Cp\u003E論理積はAND。数式上では\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmo\u003E∧\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\land\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.5556em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E∧\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E、コードでは\u003Ccode\u003E&amp;\u003C\u002Fcode\u003Eで表します。\u003Cbr\u003E\\n論理和はOR。数式上では\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmo\u003E∨\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\lor\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.5556em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E∨\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E、コードでは\u003Ccode\u003E|\u003C\u002Fcode\u003Eで表します。\u003Cbr\u003E\\n排他的論理和はXOR。数式上では$\\\\oplus$、コードでは\u003Ccode\u003E^\u003C\u002Fcode\u003Eで表します。\u003C\u002Fp\u003E\\n\u003Cp\u003E左シフト演算はビット列を左にnビット動かすやつです。値は\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsup\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003C\u002Fmsup\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E2^n\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6644em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.6644em;\\\"\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003En\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E倍になります。数式上では\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmo\u003E≪\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\ll\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.5782em;vertical-align:-0.0391em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E≪\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E、コードでは\u003Ccode\u003E&lt;&lt;\u003C\u002Fcode\u003Eで表します。\u003Cbr\u003E\\n右シフト演算はビット列を右にnビット動かすやつです。値は\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsup\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003Cmrow\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003C\u002Fmrow\u003E\u003C\u002Fmsup\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E2^{-n}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.7713em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.7713em;\\\"\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003En\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E倍になります。数式上では\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmo\u003E≫\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\gg\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.5782em;vertical-align:-0.0391em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E≫\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E、コードでは符号なしの右シフト演算を使用するので\u003Ccode\u003E&gt;&gt;&gt;\u003C\u002Fcode\u003Eで表します。\u003C\u002Fp\u003E\\n\u003Ch2\u003E下準備\u003C\u002Fh2\u003E\\n\u003Cp\u003ESHA256のハッシュ関数ではメッセージを512bitsのブロックに分けてハッシュ値を算出します。その際に余りや不足が出ては困るので、プリプロセスとして平文のPadding処理を行います。\u003C\u002Fp\u003E\\n\u003Ch3\u003EPadding関数\u003C\u002Fh3\u003E\\n\u003Cp\u003EこのPadding処理ではメッセージを512bitsの倍数にして返します。実際の実装ではbyte単位で考えるので512bits = 64byte、64の倍数に拡張して返すという処理になります。\u003C\u002Fp\u003E\\n\u003Ch5\u003E手順\u003C\u002Fh5\u003E\\n\u003Cp\u003E具体的にはメッセージの末尾に\u003Ccode\u003E0x80(bit単位の1)\u003C\u002Fcode\u003Eを加え、残りをメッセージのサイズを表すbyte列と0で埋めるという関数を書くことになります。メッセージサイズを表すbyte列は8bytesで、64bytesからその8bytesを引き、メッセージ分のbyteと\u003Ccode\u003E0x80\u003C\u002Fcode\u003Eの1byteを引いた残りのbyteは0で埋めます。\u003C\u002Fp\u003E\\n\u003Ch5\u003E実装\u003C\u002Fh5\u003E\\n\u003Cp\u003Epadding関数ではメッセージの文字列を引数にとって、64bytesの倍数にした16進数のbyte列を文字列の型で返すものです。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeLastBlock\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Mの末尾のブロックサイズ\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeMLengthBuffer\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 最終的なメッセージの末尾8bytesはMのサイズを記述する\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeDivision\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-number\\\"\u003E1\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F メッセージバイトと余りの0byteの区切り（0x80）\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeMaxBlock\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = sizeLastBlock - sizeMLengthBuffer - sizeDivision; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F メッセージバイトは55bytes以下であれば良い\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eここは上で説明したサイズをbyteで表したものです。最後の\u003Ccode\u003EsizeMaxBlock\u003C\u002Fcode\u003Eは、メッセージを入れられるbyte数を算出しています。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-built_in\\\"\u003EencodeURI\u003C\u002Fspan\u003E(M).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ereplace\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-regexp\\\"\u003E\u002F%..\u002Fg\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;*&quot;\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E;\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eここではメッセージのbyte数を取得しています。\u003Ccode\u003EM.length\u003C\u002Fcode\u003Eだと全角文字や絵文字の場合正確に取得できないため一度UTF-8でエンコードして長さを測ります。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeLastM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = sizeM % \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EisOverflow\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Eboolean\u003C\u002Fspan\u003E = sizeMaxBlock &lt; sizeLastM;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (isOverflow) sizeLastBlock = \u003Cspan class=\\\"hljs-number\\\"\u003E128\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Mの最後のブロックのバイトサイズが55bytesを超えていると1ブロックに格納できないため１ブロック追加する\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E最後のブロックは末尾にメッセージサイズのバイトと区切りの\u003Ccode\u003E0x80\u003C\u002Fcode\u003Eが入るので\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmn\u003E64\u003C\u002Fmn\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmn\u003E8\u003C\u002Fmn\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmn\u003E55\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E64-8-1=55\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.7278em;vertical-align:-0.0833em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E64\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.7278em;vertical-align:-0.0833em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E8\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E55\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Ebytesになります。なので64bytesに切り刻んだ最後のブロックが\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmn\u003E55\u003C\u002Fmn\u003E\u003Cmo\u003E&lt;\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E≤\u003C\u002Fmo\u003E\u003Cmn\u003E64\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E55 &lt; x \\\\le 64\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6835em;vertical-align:-0.0391em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E55\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.7719em;vertical-align:-0.136em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E≤\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E64\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Ebytesだった場合、もう一つブロックを増やす=最後のブロックを128bytesにしておく必要があります。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexStringM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E.\u003Cspan class=\\\"hljs-title function_\\\"\u003Efrom\u003C\u002Fspan\u003E((\u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003ETextEncoder\u003C\u002Fspan\u003E()).\u003Cspan class=\\\"hljs-title function_\\\"\u003Eencode\u003C\u002Fspan\u003E(M)).\u003Cspan class=\\\"hljs-title function_\\\"\u003Emap\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Ev\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E v.\u003Cspan class=\\\"hljs-title function_\\\"\u003EtoString\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E)).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E);\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E文字列を16進数に変換しています。一回メッセージをUTF-8でエンコードし、それを一文字ずつ16進数文字列に変換しています。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeExtra\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = (sizeLastBlock - sizeMLengthBuffer - sizeDivision - sizeLastM) * \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexExtraString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(sizeExtra).\u003Cspan class=\\\"hljs-title function_\\\"\u003Efill\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E);\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E0を入れる余りのbyte数を\u003Ccode\u003EsizeExtra\u003C\u002Fcode\u003Eに代入し、\u003Ccode\u003EhexExtraString\u003C\u002Fcode\u003Eに実際の文字列を入れています。\u003Ccode\u003EsizeExtra\u003C\u002Fcode\u003Eの最後で2倍しているのは、のちに文字列を16進数の数値に変換した際に1文字の0だとその次の0と結合して16進数の\u003Ccode\u003E0x00\u003C\u002Fcode\u003Eが生成されてしまうためです。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E hexSizeM : \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E= (sizeM * \u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003EtoString\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Ehex8bytesLengthM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E - hexSizeM.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Efill\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Econcat\u003C\u002Fspan\u003E(hexSizeM).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E);\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eメッセージの末尾に挿入するメッセージサイズの8bytesを生成しています。\u003Ccode\u003EhexSizeM\u003C\u002Fcode\u003Eにサイズを表す16進数文字列を代入し、\u003Ccode\u003Ehex8bytesLengthM\u003C\u002Fcode\u003Eで8bytes内で使われなかったbytesに加える0と\u003Ccode\u003EhexSizeM\u003C\u002Fcode\u003Eを結合しています。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EresultString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = hexStringM + \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;80&quot;\u003C\u002Fspan\u003E + hexExtraString + hex8bytesLengthM;\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E最終的に戻り値となる文字列を生成しています。\u003C\u002Fp\u003E\\n\u003Ch3\u003EDivide関数\u003C\u002Fh3\u003E\\n\u003Cp\u003EPadding処理によって64bytesの倍数になったメッセージを、64bytesごとに切り分けます。わざわざ関数に分けるほどでもありませんがPreprocessなので一応。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E divideM = (\u003Cspan class=\\\"hljs-attr\\\"\u003EM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E[] =&gt; {\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 文字列として扱っているので64bytesは128文字\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EarrayM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-title class_\\\"\u003ERegExpMatchArray\u003C\u002Fspan\u003E | \u003Cspan class=\\\"hljs-literal\\\"\u003Enull\u003C\u002Fspan\u003E = M.\u003Cspan class=\\\"hljs-title function_\\\"\u003Ematch\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-regexp\\\"\u003E\u002F.{128}\u002Fg\u003C\u002Fspan\u003E);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (!arrayM) \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EError\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Failed to divide message&quot;\u003C\u002Fspan\u003E);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E arrayM;\\n};\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch2\u003E使用する関数を定義しちゃう\u003C\u002Fh2\u003E\\n\u003Cp\u003E下準備が終わったら、いよいよハッシュ値の算出に移ります。その際に繰り返し使用する関数をここで定義しておきます。\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E≫\u003C\u002Fmo\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E∨\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E≪\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmn\u003E32\u003C\u002Fmn\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{ROTR}^{n}(x)=(x\\\\gg n)\\\\lor (x \\\\ll (32 - n))\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.7376em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003En\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E≫\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003En\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E∨\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E≪\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E32\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003En\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E))\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsup\u003E\u003Cmtext\u003ESHR\u003C\u002Fmtext\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E≫\u003C\u002Fmo\u003E\u003Cmi\u003En\u003C\u002Fmi\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{SHR}^{n}(x)=x\\\\gg n\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003ESHR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.7376em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003En\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.5782em;vertical-align:-0.0391em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E≫\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.4306em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003En\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmtext\u003ECh\u003C\u002Fmtext\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Ey\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Ez\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E∧\u003C\u002Fmo\u003E\u003Cmi\u003Ey\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E¬\u003C\u002Fmi\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E∧\u003C\u002Fmo\u003E\u003Cmi\u003Ez\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{Ch}(x,y,z) = (x \\\\land y)\\\\oplus(\\\\lnot x \\\\land z)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003ECh\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.04398em;\\\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E∧\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E¬\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E∧\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.04398em;\\\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmtext\u003EMaj\u003C\u002Fmtext\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Ey\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Ez\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E∧\u003C\u002Fmo\u003E\u003Cmi\u003Ey\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo\u003E∧\u003C\u002Fmo\u003E\u003Cmi\u003Ez\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ey\u003C\u002Fmi\u003E\u003Cmo\u003E∧\u003C\u002Fmo\u003E\u003Cmi\u003Ez\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{Maj}(x,y,z) = (x \\\\land y)\\\\oplus(x \\\\land z)\\\\oplus(y \\\\land z)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EMaj\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.04398em;\\\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E∧\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E∧\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.04398em;\\\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E∧\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.04398em;\\\"\u003Ez\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsubsup\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003EΣ\u003C\u002Fmi\u003E\u003Cmn\u003E0\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E13\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E22\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\Sigma^{256}_0(x) = \\\\text{ROTR}^{2}(x)\\\\oplus\\\\text{ROTR}^{13}(x)\\\\oplus\\\\text{ROTR}^{22}(x)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EΣ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E0\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E13\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E22\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsubsup\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003EΣ\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E6\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E11\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E25\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\Sigma^{256}_1(x) = \\\\text{ROTR}^{6}(x)\\\\oplus\\\\text{ROTR}^{11}(x)\\\\oplus\\\\text{ROTR}^{25}(x)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EΣ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E6\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E11\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E25\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsubsup\u003E\u003Cmi\u003Eσ\u003C\u002Fmi\u003E\u003Cmn\u003E0\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E7\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E18\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003ESHR\u003C\u002Fmtext\u003E\u003Cmn\u003E3\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\sigma^{256}_0(x) = \\\\text{ROTR}^{7}(x)\\\\oplus\\\\text{ROTR}^{18}(x)\\\\oplus\\\\text{SHR}^{3}(x)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Eσ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E0\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E7\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E18\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003ESHR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E3\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsubsup\u003E\u003Cmi\u003Eσ\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E17\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003EROTR\u003C\u002Fmtext\u003E\u003Cmn\u003E19\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E⊕\u003C\u002Fmo\u003E\u003Cmsup\u003E\u003Cmtext\u003ESHR\u003C\u002Fmtext\u003E\u003Cmn\u003E10\u003C\u002Fmn\u003E\u003C\u002Fmsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ex\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\sigma^{256}_1(x) = \\\\text{ROTR}^{17}(x)\\\\oplus\\\\text{ROTR}^{19}(x)\\\\oplus\\\\text{SHR}^{10}(x)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Eσ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E17\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EROTR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E19\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E⊕\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.1373em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003ESHR\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8873em;\\\"\u003E\u003Cspan style=\\\"top:-3.1362em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E10\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F ROTR関数の定義\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E rotr = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003En\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E ((x &gt;&gt;&gt; n) | (x &lt;&lt; (\u003Cspan class=\\\"hljs-number\\\"\u003E32\u003C\u002Fspan\u003E - n))) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F SHR関数の定義\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E shr = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003En\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (x &gt;&gt;&gt; n) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E ch = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ey\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ez\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E ((x &amp; y) ^ (~x &amp; z)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E maj = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ey\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ez\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E upperSigma0 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E13\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E22\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E upperSigma1 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E6\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E11\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E25\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E lowerSigma0 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E18\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Eshr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E3\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E lowerSigma1 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E17\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E19\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Eshr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E10\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch2\u003E定数を定義しちゃう\u003C\u002Fh2\u003E\\n\u003Cp\u003Eハッシュ値算出の際に使う定数も定義しておきましょう。といっても定数が64個入る配列を一つ作るだけです。\u003Cbr\u003E\\n配列の中身は、\u003Cstrong\u003E小さい方から64個の素数の立方根の小数点以下4bytes\u003C\u002Fstrong\u003Eです。例えば配列のいちばん最初は最初の素数である2の立方根\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmroot\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003Cmn\u003E3\u003C\u002Fmn\u003E\u003C\u002Fmroot\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmn\u003E1.2599210498\u003C\u002Fmn\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmtext\u003E1.428a2f986ed84\u003C\u002Fmtext\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E.\u003C\u002Fmi\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E.\u003C\u002Fmi\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E.\u003C\u002Fmi\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\sqrt[3]{2}=1.2599210498=\\\\text{1.428a2f986ed84}...\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.04em;vertical-align:-0.1328em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord sqrt\\\"\u003E\u003Cspan class=\\\"root\\\"\u003E\u003Cspan class=\\\"vlist-t\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.7869em;\\\"\u003E\u003Cspan style=\\\"top:-2.9647em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.5em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size1 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E3\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.9072em;\\\"\u003E\u003Cspan class=\\\"svg-align\\\" style=\\\"top:-3em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:3em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\" style=\\\"padding-left:0.833em;\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-2.8672em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:3em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"hide-tail\\\" style=\\\"min-width:0.853em;height:1.08em;\\\"\u003E\u003Csvg xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\\\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003E\u003Cpath d='M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z'\u002F\u003E\u003C\u002Fsvg\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.1328em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E1.2599210498\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6944em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E1.428a2f986ed84\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E...\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eの小数点以下4bytes\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmtext\u003E428a2f98\u003C\u002Fmtext\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{428a2f98}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6944em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E428a2f98\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eになります。なんでこんな値を取ってくるのでしょうか。僕にも分かりません。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EK\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] = [\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x428a2f98\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x71374491\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xb5c0fbcf\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xe9b5dba5\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x3956c25b\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x59f111f1\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x923f82a4\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xab1c5ed5\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xd807aa98\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x12835b01\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x243185be\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x550c7dc3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x72be5d74\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x80deb1fe\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x9bdc06a7\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc19bf174\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xe49b69c1\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xefbe4786\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x0fc19dc6\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x240ca1cc\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x2de92c6f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x4a7484aa\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x5cb0a9dc\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x76f988da\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x983e5152\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa831c66d\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xb00327c8\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0xbf597fc7\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc6e00bf3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xd5a79147\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x06ca6351\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x14292967\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x27b70a85\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x2e1b2138\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x4d2c6dfc\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x53380d13\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x650a7354\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x766a0abb\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x81c2c92e\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x92722c85\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa2bfe8a1\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa81a664b\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc24b8b70\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc76c51a3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xd192e819\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0xd6990624\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xf40e3585\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x106aa070\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x19a4c116\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x1e376c08\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x2748774c\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x34b0bcb5\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x391c0cb3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x4ed8aa4a\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x5b9cca4f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x682e6ff3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x748f82ee\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x78a5636f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x84c87814\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x8cc70208\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x90befffa\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa4506ceb\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xbef9a3f7\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0xc67178f2\u003C\u002Fspan\u003E\\n];\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E定数ですので実行するたびに「小さい方から64個の素数の立方根の小数点以下4byteを取ってきて配列に入れて…」とかやる必要はありません。\u003C\u002Fp\u003E\\n\u003Ch2\u003Eハッシュ値を算出していく\u003C\u002Fh2\u003E\\n\u003Cp\u003Eいよいよ本題です。ハッシュ値の算出手順は、まず先ほど64bytesごとに切り分けたメッセージブロックをさらに4bytesのブロック、つまり半角文字1文字ずつに切り分けます。そしてそのWord一つ一つに対してローテーションという処理を行っていきます。\u003C\u002Fp\u003E\\n\u003Cp\u003E以降、足し算の際には、32bits符号なし整数型であることを保証するため必ず\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmtext\u003E0x100000000\u003C\u002Fmtext\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{0x100000000}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E0x100000000\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eとの剰余をとります。実装の際には\u003Ccode\u003E&amp; 0xffffffff\u003C\u002Fcode\u003Eと論理積を使って剰余を擬似的に再現します。\u003C\u002Fp\u003E\\n\u003Ch3\u003Eハッシュ値を入れる配列を定義する\u003C\u002Fh3\u003E\\n\u003Cp\u003Eまずはローテーション処理の肝となる配列を定義します\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EH\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] = [\u003Cspan class=\\\"hljs-number\\\"\u003E0x6a09e667\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xbb67ae85\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x3c6ef372\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa54ff53a\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x510e527f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x9b05688c\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x1f83d9ab\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x5be0cd19\u003C\u002Fspan\u003E];\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eこれは後々ハッシュ値が格納され、ローテーション処理に使われる配列です。上の初期値は\u003Cstrong\u003E小さい方から8個の素数の平方根の小数点以下32bits\u003C\u002Fstrong\u003Eです。先ほどの定数\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003EK\u003C\u002Fmi\u003E\u003Cmn\u003E0\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EK\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EK\u003C\u002Fmi\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E.\u003C\u002Fmi\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E.\u003C\u002Fmi\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003E.\u003C\u002Fmi\u003E\u003Cmsub\u003E\u003Cmi\u003EK\u003C\u002Fmi\u003E\u003Cmn\u003E63\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003EK_{0},K_{1},K_{2}...K_{63}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8778em;vertical-align:-0.1944em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.07153em;\\\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E0\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.07153em;\\\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.07153em;\\\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.07153em;\\\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E63\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eは立方根でしたが今回は平方根です。ほんとなんなんでしょうねこれ。\u003C\u002Fp\u003E\\n\u003Ch3\u003Eブロックをさらに切り分ける\u003C\u002Fh3\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EpaddedString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title function_\\\"\u003Epadding\u003C\u002Fspan\u003E(M);\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EdividedM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E[] = \u003Cspan class=\\\"hljs-title function_\\\"\u003EdivideM\u003C\u002Fspan\u003E(paddedString);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E i = \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E; i &lt; dividedM.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E; i++) {\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-title class_\\\"\u003ERegExpMatchArray\u003C\u002Fspan\u003E | \u003Cspan class=\\\"hljs-literal\\\"\u003Enull\u003C\u002Fspan\u003E = dividedM[i].\u003Cspan class=\\\"hljs-title function_\\\"\u003Ematch\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-regexp\\\"\u003E\u002F.{8}\u002Fg\u003C\u002Fspan\u003E); \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 64bytesのブロックをさらに4byteずつ刻んでいく\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (!\u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E) \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EError\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Failed to divide dividedM&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EW\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] = \u003Cspan class=\\\"hljs-title function_\\\"\u003EmapW\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E), \u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E);\\n    ...\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E先述の\u003Ccode\u003EdivideM\u003C\u002Fcode\u003E関数で切り分けた64bytesのブロック一つ一つについて、\u003Ccode\u003EMi\u003C\u002Fcode\u003Eに4bytesづつ切り分けた変数を格納しています。ここで正規表現で8文字ずつ切り出しているのはPadding関数の時と同じく、後々数値に変換する際に2文字ごとに１６進数として読んでもらう必要があるからです。\u003Cbr\u003E\\n最後の\u003Ccode\u003EmapW\u003C\u002Fcode\u003E関数では\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003EW\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6833em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eという64個の要素を持つ配列を生成します。それでは\u003Ccode\u003EmapW\u003C\u002Fcode\u003E関数の中身をみてみましょう\u003C\u002Fp\u003E\\n\u003Ch3\u003EWを作る\u003C\u002Fh3\u003E\\n\u003Cp\u003Eハッシュ値の算出に必要な\u003Cstrong\u003Eメッセージスケジュール\u003C\u002Fstrong\u003Eなるものを\u003Ccode\u003EmapW\u003C\u002Fcode\u003E関数で生成します。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E mapW = (\u003Cspan class=\\\"hljs-attr\\\"\u003Earray64\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[], \u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E[]): \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] =&gt; {\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E i = \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E; i &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E; i++) {\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexNum\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-built_in\\\"\u003EparseInt\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E[i], \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (i &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E) {\\n      array64[i] = hexNum;\\n      \u003Cspan class=\\\"hljs-keyword\\\"\u003Econtinue\u003C\u002Fspan\u003E;\\n    }\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Etmp\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title function_\\\"\u003ElowerSigma1\u003C\u002Fspan\u003E(array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E]) + array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E] + \u003Cspan class=\\\"hljs-title function_\\\"\u003ElowerSigma0\u003C\u002Fspan\u003E(array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E15\u003C\u002Fspan\u003E]) + array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E];\\n\\n    array64[i] = (tmp &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  }\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E array64;\\n};\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E第一引数には64個の空要素を持つ配列、第二引数にはブロックを4bytesに切り刻んだ配列をとります。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexNum\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-built_in\\\"\u003EparseInt\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E[i], \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eこの数値化部分で、これまで0をbyte×2個生成したりbyte×2文字でブロックを切り分けたりしていたことが生きてきます。そうやって半ば強引に生成した擬似的な16進数文字列のおかげで論理演算やシフト演算が円滑に行えるのです。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eif (i &lt; 16) {\\n  array64[i] = hexNum;\\n  continue;\\n}\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003EW\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6833em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eの1~16番目には数値化したメッセージブロック4bytesを格納します。\u003Cbr\u003E\\nそれ以降のインデックスには以下の式で算出した値を格納します。\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003C\u002Fmsub\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmsubsup\u003E\u003Cmi\u003Eσ\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003Cmrow\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003C\u002Fmsub\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003Cmrow\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmn\u003E7\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003C\u002Fmsub\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsubsup\u003E\u003Cmi\u003Eσ\u003C\u002Fmi\u003E\u003Cmn\u003E0\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003Cmrow\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmn\u003E15\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003C\u002Fmsub\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003Cmrow\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003Cmo\u003E−\u003C\u002Fmo\u003E\u003Cmn\u003E16\u003C\u002Fmn\u003E\u003C\u002Fmrow\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003EW_{t}=\\\\sigma^{256}_1(W_{t-2})+W_{t-7}+\\\\sigma^{256}_0(W_{t-15})+W_{t-16}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2806em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Eσ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin mtight\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2083em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8917em;vertical-align:-0.2083em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin mtight\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E7\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2083em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Eσ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E0\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin mtight\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E15\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2083em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8917em;vertical-align:-0.2083em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin mtight\\\"\u003E−\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E16\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2083em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\nかなりややこしいですが先ほど定義しておいた関数に当てはめるだけなので実装自体は単純です。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Etmp\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title function_\\\"\u003ElowerSigma1\u003C\u002Fspan\u003E(array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E]) + array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E] + \u003Cspan class=\\\"hljs-title function_\\\"\u003ElowerSigma0\u003C\u002Fspan\u003E(array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E15\u003C\u002Fspan\u003E]) + array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E];\\n\\n  array64[i] = (tmp &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E array64; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Wを返してmapW関数は終了\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E途中の\u003Ccode\u003E(tmp &amp; 0xffffffff) &gt;&gt;&gt; 0\u003C\u002Fcode\u003Eの最後の符号なし右シフトは何をしているのかというと、tmpの値と\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmtext\u003E0xffffffff\u003C\u002Fmtext\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003E\\\\text{0xffffffff}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.6944em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003E0xffffffff\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eの剰余を強制的に符号なし、つまりプラスの値に変換しているのです。他の言語であればこんなことしなくても符号なしの演算はできるのですが、\u003Cstrong\u003EJavaScriptはこの符号なし右シフト以外で確実に非負の数であると保証する方法はありません。\u003C\u002Fstrong\u003E\u003Ccode\u003E(tmp &amp; 0xffffffff)\u003C\u002Fcode\u003Eがすでに非負だった場合この演算は無意味ですが、負の数だった場合はこのめんどい作業が必要になります。\u003C\u002Fp\u003E\\n\u003Ch3\u003E前のブロックで生成されたハッシュ値を変数に代入する\u003C\u002Fh3\u003E\\n\u003Cp\u003Eメインのハッシュ値算出関数に戻ります。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E a, b, c, d, e, f, g, h;\\n\\n[a, b, c, d, e, f, g, h] = [...H];\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eここで変数a~hにブロックごとのループの最後で生成されるハッシュ値、つまり一つ前のブロックのハッシュ値を代入していきます。\u003C\u002Fp\u003E\\n\u003Ch3\u003EWを使ったローテーション\u003C\u002Fh3\u003E\\n\u003Cp\u003E先ほど\u003Ccode\u003EmapW\u003C\u002Fcode\u003E関数で生成したW配列をイテレートして上の変数a~hの値をローテーションしていきます。\u003Cbr\u003E\\nイテレートが始まったら、最初に一時的に値を保管す変数\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003ET_{1}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eと\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003ET_{2}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eを定義します。\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmtext\u003Eh\u003C\u002Fmtext\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsubsup\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003EΣ\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ee\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmtext\u003ECh\u003C\u002Fmtext\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ee\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Ef\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Eg\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EK\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003C\u002Fmsub\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003EW\u003C\u002Fmi\u003E\u003Cmi\u003Et\u003C\u002Fmi\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003ET_{1}=\\\\text{h}+\\\\Sigma^{256}_{1}(e)+\\\\text{Ch}(e,f,g)+K_{t}+W_{t}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.7778em;vertical-align:-0.0833em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003Eh\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EΣ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003ECh\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.10764em;\\\"\u003Ef\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.03588em;\\\"\u003Eg\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.07153em;\\\"\u003EK\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2806em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003EW\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2806em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mathnormal mtight\\\"\u003Et\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003Cbr\u003E\\n\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003Cmo\u003E=\u003C\u002Fmo\u003E\u003Cmsubsup\u003E\u003Cmi mathvariant=\\\"normal\\\"\u003EΣ\u003C\u002Fmi\u003E\u003Cmn\u003E0\u003C\u002Fmn\u003E\u003Cmn\u003E256\u003C\u002Fmn\u003E\u003C\u002Fmsubsup\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ea\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmtext\u003EMaj\u003C\u002Fmtext\u003E\u003Cmo stretchy=\\\"false\\\"\u003E(\u003C\u002Fmo\u003E\u003Cmi\u003Ea\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Eb\u003C\u002Fmi\u003E\u003Cmo separator=\\\"true\\\"\u003E,\u003C\u002Fmo\u003E\u003Cmi\u003Ec\u003C\u002Fmi\u003E\u003Cmo stretchy=\\\"false\\\"\u003E)\u003C\u002Fmo\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003ET_{2}=\\\\Sigma^{256}_{0}(a)+\\\\text{Maj}(a,b,c)\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mrel\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EΣ\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003E\u003Cspan style=\\\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E0\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E256\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.2481em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord text\\\"\u003E\u003Cspan class=\\\"mord\\\"\u003EMaj\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mopen\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ea\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Eb\u003C\u002Fspan\u003E\u003Cspan class=\\\"mpunct\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ec\u003C\u002Fspan\u003E\u003Cspan class=\\\"mclose\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E t = \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E; t &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E; t++) {\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003ET1\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = ((h + \u003Cspan class=\\\"hljs-title function_\\\"\u003EupperSigma1\u003C\u002Fspan\u003E(e) + \u003Cspan class=\\\"hljs-title function_\\\"\u003Ech\u003C\u002Fspan\u003E(e, f, g) + K[t] + W[t]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003ET2\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = ((\u003Cspan class=\\\"hljs-title function_\\\"\u003EupperSigma0\u003C\u002Fspan\u003E(a) + \u003Cspan class=\\\"hljs-title function_\\\"\u003Emaj\u003C\u002Fspan\u003E(a, b, c)) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n  h = g;\\n  g = f;\\n  f = e;\\n  e = ((d + \u003Cspan class=\\\"hljs-variable constant_\\\"\u003ET1\u003C\u002Fspan\u003E) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  d = c;\\n  c = b;\\n  b = a;\\n  a = ((\u003Cspan class=\\\"hljs-variable constant_\\\"\u003ET1\u003C\u002Fspan\u003E + \u003Cspan class=\\\"hljs-variable constant_\\\"\u003ET2\u003C\u002Fspan\u003E) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003Eeとa以外はひとつ前のアルファベットの値が代入されるだけで、eは\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmi\u003Ed\u003C\u002Fmi\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003Ed+T_{1}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.7778em;vertical-align:-0.0833em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord mathnormal\\\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003E、aは\u003Ceq\u003E\u003Cspan class=\\\"katex\\\"\u003E\u003Cspan class=\\\"katex-mathml\\\"\u003E\u003Cmath xmlns=\\\"http:\u002F\u002Fwww.w3.org\u002F1998\u002FMath\u002FMathML\\\"\u003E\u003Csemantics\u003E\u003Cmrow\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E1\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003Cmo\u003E+\u003C\u002Fmo\u003E\u003Cmsub\u003E\u003Cmi\u003ET\u003C\u002Fmi\u003E\u003Cmn\u003E2\u003C\u002Fmn\u003E\u003C\u002Fmsub\u003E\u003C\u002Fmrow\u003E\u003Cannotation encoding=\\\"application\u002Fx-tex\\\"\u003ET_{1}+T_{2}\u003C\u002Fannotation\u003E\u003C\u002Fsemantics\u003E\u003C\u002Fmath\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E1\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mbin\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"base\\\"\u003E\u003Cspan class=\\\"strut\\\" style=\\\"height:0.8333em;vertical-align:-0.15em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"mord\\\"\u003E\u003Cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.13889em;\\\"\u003ET\u003C\u002Fspan\u003E\u003Cspan class=\\\"msupsub\\\"\u003E\u003Cspan class=\\\"vlist-t vlist-t2\\\"\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.3011em;\\\"\u003E\u003Cspan style=\\\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\\\"\u003E\u003Cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E\u003Cspan class=\\\"mord mtight\\\"\u003E2\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-s\\\"\u003E​\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"vlist-r\\\"\u003E\u003Cspan class=\\\"vlist\\\" style=\\\"height:0.15em;\\\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Feq\u003Eになります。これをW内の要素全て、つまり64回分行います。\u003Cbr\u003E\\nメッセージをabcとしてこのローテーション処理を行った際のa~hの変化が以下です\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E5d6aebcd 6a09e667 bb67ae85 3c6ef372 fa2a4622 510e527f 9b05688c 1f83d9ab\\n5a6ad9ad 5d6aebcd 6a09e667 bb67ae85 78ce7989 fa2a4622 510e527f 9b05688c\\nc8c347a7 5a6ad9ad 5d6aebcd 6a09e667 f92939eb 78ce7989 fa2a4622 510e527f\\nd550f666 c8c347a7 5a6ad9ad 5d6aebcd 24e00850 f92939eb 78ce7989 fa2a4622\\n4409a6a d550f666 c8c347a7 5a6ad9ad 43ada245 24e00850 f92939eb 78ce7989\\n2b4209f5 4409a6a d550f666 c8c347a7 714260ad 43ada245 24e00850 f92939eb\\ne5030380 2b4209f5 4409a6a d550f666 9b27a401 714260ad 43ada245 24e00850\\n85a07b5f e5030380 2b4209f5 4409a6a c657a79 9b27a401 714260ad 43ada245\\n8e04ecb9 85a07b5f e5030380 2b4209f5 32ca2d8c c657a79 9b27a401 714260ad\\n8c87346b 8e04ecb9 85a07b5f e5030380 1cc92596 32ca2d8c c657a79 9b27a401\\n4798a3f4 8c87346b 8e04ecb9 85a07b5f 436b23e8 1cc92596 32ca2d8c c657a79\\nf71fc5a9 4798a3f4 8c87346b 8e04ecb9 816fd6e9 436b23e8 1cc92596 32ca2d8c\\n87912990 f71fc5a9 4798a3f4 8c87346b 1e578218 816fd6e9 436b23e8 1cc92596\\nd932eb16 87912990 f71fc5a9 4798a3f4 745a48de 1e578218 816fd6e9 436b23e8\\n続く...\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E斜めに値がローテーションし、一番左と左から5行目、つまりaとeで毎度値が変わっているのが分かるはずです。\u003C\u002Fp\u003E\\n\u003Ch3\u003E前のハッシュ値とa~hを足す\u003C\u002Fh3\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E  H[\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E] = ((a + H[\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E1\u003C\u002Fspan\u003E] = ((b + H[\u003Cspan class=\\\"hljs-number\\\"\u003E1\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E] = ((c + H[\u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E3\u003C\u002Fspan\u003E] = ((d + H[\u003Cspan class=\\\"hljs-number\\\"\u003E3\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E4\u003C\u002Fspan\u003E] = ((e + H[\u003Cspan class=\\\"hljs-number\\\"\u003E4\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E5\u003C\u002Fspan\u003E] = ((f + H[\u003Cspan class=\\\"hljs-number\\\"\u003E5\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E6\u003C\u002Fspan\u003E] = ((g + H[\u003Cspan class=\\\"hljs-number\\\"\u003E6\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  H[\u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E] = ((h + H[\u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n}\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F ↖︎次のブロックへ\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E前のブロックのハッシュ値とa~hの値を加算し、このブロックのハッシュ値が完成します。\u003C\u002Fp\u003E\\n\u003Ch2\u003Eハッシュ値をハッシュ値にする\u003C\u002Fh2\u003E\\n\u003Cp\u003E以上の流れをブロック数回行うと、最後のHには一方向性と耐衝突性を持つハッシュ値が格納された状態になります。しかしこのままでは配列なので、それを結合して文字列の形に直します。\u003Cbr\u003E\\n配列を結合するだけなら簡単なのですが、ここでも少し罠があったので紹介します。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Eresult\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E;\\n\\nH.\u003Cspan class=\\\"hljs-title function_\\\"\u003Emap\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Eb\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhashString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = b.\u003Cspan class=\\\"hljs-title function_\\\"\u003EtoString\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E(hashString.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E) {\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EextraZeros\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E - hashString.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Efill\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&#x27;&#x27;\u003C\u002Fspan\u003E);\\n    hashString = extraZeros + hashString;\\n  }\\n  result += hashString;\\n});\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E(result.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E !== \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E) \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EError\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Hash result is not 32bytes&quot;\u003C\u002Fspan\u003E);\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E result; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F SHA-256完成！\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E真ん中のHをイテレートしている部分は何をやっているのかというと、配列の要素ひとつひとつの文字数を測り、8文字に満たない場合はその分0を先頭に追加しています。これは、\u003Ccode\u003EhashString\u003C\u002Fcode\u003Eで数値を文字列に変換した際に、先頭に0があるとそれは省略されて文字列化されてしまうのです。そうすると結果が256bitsでなくなってしまうので、無理矢理ではありますが省略分の0を加える必要があるのです。\u003C\u002Fp\u003E\\n\u003Ch2\u003Eソースコード\u003C\u002Fh2\u003E\\n\u003Cp\u003Eだいぶ細々と説明をしてきたので、最後に全体のソースコードを貼っておきます。これは一番上で貼ったリポジトリでも見ることができます。\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode class=\\\"language-typescript\\\"\u003E\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 文字列を引数にとり、64の倍数bytesのHex文字列を返す\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E padding = (\u003Cspan class=\\\"hljs-attr\\\"\u003EM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Estring\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeLastBlock\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Mの末尾のブロックサイズ\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeMLengthBuffer\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 最終的なメッセージの末尾8bytesはMのサイズを記述する\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeDivision\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-number\\\"\u003E1\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F メッセージバイトと余りの0バイトの区切り（0x80）\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeMaxBlock\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = sizeLastBlock - sizeMLengthBuffer - sizeDivision; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F メッセージバイトは55bytes以下であれば良い\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-built_in\\\"\u003EencodeURI\u003C\u002Fspan\u003E(M).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ereplace\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-regexp\\\"\u003E\u002F%..\u002Fg\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;*&quot;\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E;\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeLastM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = sizeM % \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E;\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EisOverflow\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Eboolean\u003C\u002Fspan\u003E = sizeMaxBlock &lt; sizeLastM;\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (isOverflow) sizeLastBlock = \u003Cspan class=\\\"hljs-number\\\"\u003E128\u003C\u002Fspan\u003E; \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Mの最後のブロックのバイトサイズが55bytesを超えていると1ブロックに格納できないため１ブロック追加する\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Mを16進数文字列に変換\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexStringM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E.\u003Cspan class=\\\"hljs-title function_\\\"\u003Efrom\u003C\u002Fspan\u003E((\u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003ETextEncoder\u003C\u002Fspan\u003E()).\u003Cspan class=\\\"hljs-title function_\\\"\u003Eencode\u003C\u002Fspan\u003E(M)).\u003Cspan class=\\\"hljs-title function_\\\"\u003Emap\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Ev\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E v.\u003Cspan class=\\\"hljs-title function_\\\"\u003EtoString\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E)).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E);\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 余りの0の配列を生成\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EsizeExtra\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = (sizeLastBlock - sizeMLengthBuffer - sizeDivision - sizeLastM) * \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E;\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexExtraString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(sizeExtra).\u003Cspan class=\\\"hljs-title function_\\\"\u003Efill\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E);\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F Mのサイズを8bytesで表現する\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E hexSizeM : \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E= (sizeM * \u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003EtoString\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Ehex8bytesLengthM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E - hexSizeM.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Efill\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Econcat\u003C\u002Fspan\u003E(hexSizeM).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E);\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 64bytesの倍数になったPaddedStringを生成\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EresultString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = hexStringM + \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;80&quot;\u003C\u002Fspan\u003E + hexExtraString + hex8bytesLengthM;\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E resultString;\\n};\\n\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 64の倍数bytesのHex文字列を引数にとり、64bytesごとに切り分けた配列を返す\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E divideM = (\u003Cspan class=\\\"hljs-attr\\\"\u003EM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E[] =&gt; {\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 文字列として扱っているので64bytesは128文字\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EarrayM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-title class_\\\"\u003ERegExpMatchArray\u003C\u002Fspan\u003E | \u003Cspan class=\\\"hljs-literal\\\"\u003Enull\u003C\u002Fspan\u003E = M.\u003Cspan class=\\\"hljs-title function_\\\"\u003Ematch\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-regexp\\\"\u003E\u002F.{128}\u002Fg\u003C\u002Fspan\u003E);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (!arrayM) \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EError\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Failed to divide message&quot;\u003C\u002Fspan\u003E);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E arrayM;\\n};\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E ch = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ey\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ez\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E ((x &amp; y) ^ (~x &amp; z)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E maj = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ey\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003Ez\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E rotr = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003En\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E ((x &gt;&gt;&gt; n) | (x &lt;&lt; (\u003Cspan class=\\\"hljs-number\\\"\u003E32\u003C\u002Fspan\u003E - n))) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E shr = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-attr\\\"\u003En\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (x &gt;&gt;&gt; n) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E upperSigma0 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E13\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E22\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E upperSigma1 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E6\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E11\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E25\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E lowerSigma0 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E18\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Eshr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E3\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E lowerSigma1 = (\u003Cspan class=\\\"hljs-attr\\\"\u003Ex\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Enumber\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E17\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Erotr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E19\u003C\u002Fspan\u003E) ^ \u003Cspan class=\\\"hljs-title function_\\\"\u003Eshr\u003C\u002Fspan\u003E(x, \u003Cspan class=\\\"hljs-number\\\"\u003E10\u003C\u002Fspan\u003E)) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 小さい方から64個の素数の立方根の小数点以下4bytesの定数\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EK\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] = [\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x428a2f98\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x71374491\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xb5c0fbcf\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xe9b5dba5\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x3956c25b\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x59f111f1\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x923f82a4\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xab1c5ed5\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xd807aa98\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x12835b01\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x243185be\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x550c7dc3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x72be5d74\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x80deb1fe\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x9bdc06a7\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc19bf174\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xe49b69c1\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xefbe4786\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x0fc19dc6\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x240ca1cc\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x2de92c6f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x4a7484aa\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x5cb0a9dc\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x76f988da\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x983e5152\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa831c66d\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xb00327c8\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0xbf597fc7\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc6e00bf3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xd5a79147\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x06ca6351\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x14292967\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x27b70a85\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x2e1b2138\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x4d2c6dfc\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x53380d13\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x650a7354\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x766a0abb\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x81c2c92e\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x92722c85\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa2bfe8a1\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa81a664b\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc24b8b70\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xc76c51a3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xd192e819\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0xd6990624\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xf40e3585\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x106aa070\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x19a4c116\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x1e376c08\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x2748774c\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x34b0bcb5\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x391c0cb3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x4ed8aa4a\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0x5b9cca4f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x682e6ff3\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x748f82ee\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x78a5636f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x84c87814\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x8cc70208\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x90befffa\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa4506ceb\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xbef9a3f7\u003C\u002Fspan\u003E,\\n  \u003Cspan class=\\\"hljs-number\\\"\u003E0xc67178f2\u003C\u002Fspan\u003E\\n];\\n\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E mapW = (\u003Cspan class=\\\"hljs-attr\\\"\u003Earray64\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[], \u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E[]): \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] =&gt; {\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E i = \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E; i &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E; i++) {\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhexNum\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-built_in\\\"\u003EparseInt\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E[i], \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (i &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E) {\\n      array64[i] = hexNum;\\n      \u003Cspan class=\\\"hljs-keyword\\\"\u003Econtinue\u003C\u002Fspan\u003E;\\n    }\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Etmp\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title function_\\\"\u003ElowerSigma1\u003C\u002Fspan\u003E(array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E]) + array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E] + \u003Cspan class=\\\"hljs-title function_\\\"\u003ElowerSigma0\u003C\u002Fspan\u003E(array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E15\u003C\u002Fspan\u003E]) + array64[i - \u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E];\\n\\n    array64[i] = (tmp &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  }\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E array64;\\n};\\n\\n\u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F メインの関数\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"hljs-keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E computeHash = (\u003Cspan class=\\\"hljs-attr\\\"\u003EM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E): \u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Estring\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\\n  \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F ブロックごとにハッシュ値が格納される配列\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EH\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] = [\u003Cspan class=\\\"hljs-number\\\"\u003E0x6a09e667\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xbb67ae85\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x3c6ef372\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0xa54ff53a\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x510e527f\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x9b05688c\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x1f83d9ab\u003C\u002Fspan\u003E, \u003Cspan class=\\\"hljs-number\\\"\u003E0x5be0cd19\u003C\u002Fspan\u003E];\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EpaddedString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title function_\\\"\u003Epadding\u003C\u002Fspan\u003E(M);\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EdividedM\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E[] = \u003Cspan class=\\\"hljs-title function_\\\"\u003EdivideM\u003C\u002Fspan\u003E(paddedString);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E i = \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E; i &lt; dividedM.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E; i++) {\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-title class_\\\"\u003ERegExpMatchArray\u003C\u002Fspan\u003E | \u003Cspan class=\\\"hljs-literal\\\"\u003Enull\u003C\u002Fspan\u003E = dividedM[i].\u003Cspan class=\\\"hljs-title function_\\\"\u003Ematch\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-regexp\\\"\u003E\u002F.{8}\u002Fg\u003C\u002Fspan\u003E); \u003Cspan class=\\\"hljs-comment\\\"\u003E\u002F\u002F 64bytesのブロックをさらに4byteずつ刻んでいく\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E (!\u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E) \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EError\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Failed to divide dividedM&quot;\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EW\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E[] = \u003Cspan class=\\\"hljs-title function_\\\"\u003EmapW\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E), \u003Cspan class=\\\"hljs-title class_\\\"\u003EMi\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E a, b, c, d, e, f, g, h;\\n\\n    [a, b, c, d, e, f, g, h] = [...H];\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E t = \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E; t &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E; t++) {\\n      \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003ET1\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = ((h + \u003Cspan class=\\\"hljs-title function_\\\"\u003EupperSigma1\u003C\u002Fspan\u003E(e) + \u003Cspan class=\\\"hljs-title function_\\\"\u003Ech\u003C\u002Fspan\u003E(e, f, g) + K[t] + W[t]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n      \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003ET2\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Enumber\u003C\u002Fspan\u003E = ((\u003Cspan class=\\\"hljs-title function_\\\"\u003EupperSigma0\u003C\u002Fspan\u003E(a) + \u003Cspan class=\\\"hljs-title function_\\\"\u003Emaj\u003C\u002Fspan\u003E(a, b, c)) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n\\n      h = g;\\n      g = f;\\n      f = e;\\n      e = ((d + \u003Cspan class=\\\"hljs-variable constant_\\\"\u003ET1\u003C\u002Fspan\u003E) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n      d = c;\\n      c = b;\\n      b = a;\\n      a = ((\u003Cspan class=\\\"hljs-variable constant_\\\"\u003ET1\u003C\u002Fspan\u003E + \u003Cspan class=\\\"hljs-variable constant_\\\"\u003ET2\u003C\u002Fspan\u003E) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    }\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E] = ((a + H[\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E1\u003C\u002Fspan\u003E] = ((b + H[\u003Cspan class=\\\"hljs-number\\\"\u003E1\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E] = ((c + H[\u003Cspan class=\\\"hljs-number\\\"\u003E2\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E3\u003C\u002Fspan\u003E] = ((d + H[\u003Cspan class=\\\"hljs-number\\\"\u003E3\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E4\u003C\u002Fspan\u003E] = ((e + H[\u003Cspan class=\\\"hljs-number\\\"\u003E4\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E5\u003C\u002Fspan\u003E] = ((f + H[\u003Cspan class=\\\"hljs-number\\\"\u003E5\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E6\u003C\u002Fspan\u003E] = ((g + H[\u003Cspan class=\\\"hljs-number\\\"\u003E6\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n    H[\u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E] = ((h + H[\u003Cspan class=\\\"hljs-number\\\"\u003E7\u003C\u002Fspan\u003E]) &amp; \u003Cspan class=\\\"hljs-number\\\"\u003E0xffffffff\u003C\u002Fspan\u003E) &gt;&gt;&gt; \u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E;\\n  }\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003Eresult\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-string\\\"\u003E&quot;&quot;\u003C\u002Fspan\u003E;\\n\\n  H.\u003Cspan class=\\\"hljs-title function_\\\"\u003Emap\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-function\\\"\u003E\u003Cspan class=\\\"hljs-params\\\"\u003Eb\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Elet\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EhashString\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = b.\u003Cspan class=\\\"hljs-title function_\\\"\u003EtoString\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E16\u003C\u002Fspan\u003E);\\n    \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E(hashString.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E &lt; \u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E) {\\n      \u003Cspan class=\\\"hljs-keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-attr\\\"\u003EextraZeros\u003C\u002Fspan\u003E: \u003Cspan class=\\\"hljs-built_in\\\"\u003Estring\u003C\u002Fspan\u003E = \u003Cspan class=\\\"hljs-title class_\\\"\u003EArray\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E8\u003C\u002Fspan\u003E - hashString.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Efill\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-number\\\"\u003E0\u003C\u002Fspan\u003E).\u003Cspan class=\\\"hljs-title function_\\\"\u003Ejoin\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&#x27;&#x27;\u003C\u002Fspan\u003E);\\n      hashString = extraZeros + hashString;\\n    }\\n    result += hashString;\\n  });\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Eif\u003C\u002Fspan\u003E(result.\u003Cspan class=\\\"hljs-property\\\"\u003Elength\u003C\u002Fspan\u003E !== \u003Cspan class=\\\"hljs-number\\\"\u003E64\u003C\u002Fspan\u003E) \u003Cspan class=\\\"hljs-keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"hljs-title class_\\\"\u003EError\u003C\u002Fspan\u003E(\u003Cspan class=\\\"hljs-string\\\"\u003E&quot;Hash result is not 32bytes&quot;\u003C\u002Fspan\u003E);\\n\\n  \u003Cspan class=\\\"hljs-keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E result;\\n};\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E最適化とは程遠いコードですが、ひとつアルゴリズムを理解できたというのは嬉しいですね。\u003C\u002Fp\u003E\\n\u003Ch2\u003E参考文献\u003C\u002Fh2\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fnvlpubs.nist.gov\u002Fnistpubs\u002FFIPS\u002FNIST.FIPS.180-4.pdf\\\"\u003Ehttps:\u002F\u002Fnvlpubs.nist.gov\u002Fnistpubs\u002FFIPS\u002FNIST.FIPS.180-4.pdf\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fqiita.com\u002Ftnakagawa\u002Fitems\u002F6321472098a2b73836ab#sha256%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E8%A8%88%E7%AE%97sha-256-hash-computation\\\"\u003Ehttps:\u002F\u002Fqiita.com\u002Ftnakagawa\u002Fitems\u002F6321472098a2b73836ab#sha256ハッシュ計算sha-256-hash-computation\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fwww.air-h.jp\u002Farticles\u002Femopro\u002F%E3%80%90go%E3%80%91%E6%9A%97%E5%8F%B7%E5%8C%96%E3%82%84%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E8%80%83%E3%81%88%E3%82%8B%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB\u002F\\\"\u003Ehttps:\u002F\u002Fwww.air-h.jp\u002Farticles\u002Femopro\u002F【go】暗号化やハッシュ化について考えるついでに\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\"}"}</script>
		</div>
	</body>
</html>
