<!DOCTYPE html>
<html lang="en">
	<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>KOTA YATAGAI | 八谷航太</title>
    <title>ローカルとクラウドのハイブリッド的なエディタ</title><meta name="description" content="SvelteでMarkdownエディタ作ったよという話" data-svelte="svelte-189on1m"><meta property="og:url" content="https://kota-yata.com" data-svelte="svelte-189on1m"><meta property="og:title" content="ローカルとクラウドのハイブリッド的なエディタ" data-svelte="svelte-189on1m"><meta property="og:image" content="https://kota-yata.com/media/slouch.webp" data-svelte="svelte-189on1m"><meta property="og:description" content="SvelteでMarkdownエディタ作ったよという話" data-svelte="svelte-189on1m"><meta name="twitter:card" content="summary_large_image" data-svelte="svelte-189on1m"><meta name="twitter:site" content="@kota_yata" data-svelte="svelte-189on1m">

		

		<link rel="modulepreload" href="/_app/start-daaae108.js">
		<link rel="modulepreload" href="/_app/chunks/vendor-495f2134.js">
		<link rel="modulepreload" href="/_app/pages/__layout.svelte-be316660.js">
		<link rel="modulepreload" href="/_app/chunks/index-6747d163.js">
		<link rel="modulepreload" href="/_app/pages/posts/_path_.svelte-2d94d26d.js">
		<link rel="modulepreload" href="/_app/chunks/page-7b278a70.js">
		<link rel="modulepreload" href="/_app/chunks/className-0b25377b.js">
		<link rel="stylesheet" href="/_app/assets/start-61d1577b.css">
		<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-0136ed43.css">
		<link rel="stylesheet" href="/_app/assets/app-d7359544.css">
		<link rel="stylesheet" href="/_app/assets/pages/posts/_path_.svelte-77f41461.css">
		<link rel="stylesheet" href="/_app/assets/page-da0bc829.css">

		<script type="module">
			import { start } from "/_app/start-daaae108.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":""},
				session: {},
				host: location.host,
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/_app/pages/__layout.svelte-be316660.js"),
						import("/_app/pages/posts/_path_.svelte-2d94d26d.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "\u002Fposts\u002Fslouch",
						query: new URLSearchParams(""),
						params: {path:"slouch"}
					}
				}
			});
		</script>
    <meta name="keyword" content="kota,yatagai,kota yatagai,八谷航太">
    <link rel="icon" href="/me.webp" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link defer
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
      rel="stylesheet">
    <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
      integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
    <link defer rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/a11y-dark.min.css"
      integrity="sha384-Mt8bPDNu0L2sVzon3+a8Rqtl4fmqaUmTPBEd/DTHiGFEQEFvf0fYLnU1DgK+ER2h" crossorigin="anonymous">
	</head>
	<body>
		<div id="svelte">


<header class="svelte-gbfwkw"><div class="left svelte-gbfwkw"><a href="/" class="svelte-gbfwkw">KOTA YATAGAI</a></div>
  <div class="right svelte-gbfwkw"><select name="language"><option value="JP">Japanese</option><option value="EN">English</option></select>
    <a href="/trip" sveltekit:prefetch class="svelte-gbfwkw"><img alt="to trip page" src="/airplane.svg" width="30px" height="30px"></a></div></header>

<main class="svelte-gbfwkw">
  

<div class="container svelte-izy1ym"><div class="profile svelte-izy1ym"><div class="container svelte-g32fgp"><img alt="myself" src="/me.webp" width="150px" height="150px" class="svelte-g32fgp">
  <div class="bio svelte-g32fgp"><h4 class="svelte-g32fgp">八谷航太</h4>
    <p class="svelte-g32fgp">18yo / ソフトウェア開発者</p></div>
  <ul class="svelte-g32fgp"><li class="svelte-g32fgp"><a href="/" class="svelte-g32fgp">Home</a></li><li class="svelte-g32fgp"><a href="/about" class="svelte-g32fgp">About</a></li><li class="svelte-g32fgp"><a href="/works" class="svelte-g32fgp">Works</a></li><li class="svelte-g32fgp"><a href="/contacts" class="svelte-g32fgp">Contacts</a></li></ul>
  <div class="icons svelte-g32fgp"><a href="https://github.com/kota-yata" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/github.svg" width="20px" height="20px"></a><a href="https://open.spotify.com/user/jgm80x9h1j84hnk4nv3hozlaf" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/spotify.svg" width="20px" height="20px"></a><a href="https://twitter.com/kota_yata" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/twitter.svg" width="20px" height="20px"></a><a href="https://speakerdeck.com/kota_yata/" sveltekit:prefetch class="svelte-g32fgp"><img alt="icon" src="/speakerdeck.svg" width="20px" height="20px"></a></div>
</div></div>
  <div class="slot svelte-izy1ym"><div class="info svelte-hf3o4"><h1 class="info-title svelte-hf3o4">ローカルとクラウドのハイブリッド的なエディタ</h1>
    <span class="info-date svelte-hf3o4">2021-02-22</span>
    <span class="info-category programming svelte-hf3o4">Programming</span></div>
  <!-- HTML_TAG_START --><p>去年の8月ごろにSvelteを知って、それ以来ちまちまとWebサイト作ったりWebアプリ作ったりしてたんですが、NuxtとかReactやったことがないのもあって仮想DOMへの憧れが捨てられませんでした。というわけで、しばらくSvelteと距離を置くための最後の作品としてMarkdownエディタを作りました。</p>
<h2>SLOUCH</h2>
<p><a href="https://slouch.dev">https://slouch.dev</a></p>
<p>FirebaseのCloud Firestoreを使ってサーバーレスでDBをいじれるようにしつつ、ほとんどのブラウザに対応している<a href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API">File System Access API</a>を使ってローカルファイルの上書きと読み込みを実現しています。なので基本はサービス上でファイルを編集し、ローカルも一緒に書き換えたい！と思った時にワンクリックでできるという良さがあります。</p>
<p>僕個人の感覚としてあんまりネイティブアプリをいっぱい入れたくないというのがあって、なのでできる限りWeb上で、めっちゃ使う場合はPWA/ネイティブアプリを入れる感じでPCの資源を節約したいわけです。そういう意味ではローカルファイルをWeb上でいじれるのはめちゃくちゃ嬉しいんですが、何せFile System Access APIは結構新しいAPIなので実装しているサービスがほとんどないんです。Webのマークダウンエディタの有名どころでいうと<a href="https://stackedit.io/">StackEdit</a>とかNotionとか（独自記法多すぎてMD感ないけど）が挙がると思うんですが、全部ローカルへのアクセスはダウンロードしかできないっつーのがどうも気に食わない。もう2021年なんだしローカルからのインポートができたって良いじゃないか…ということで自作しました。</p>
<p>実を言うと、去年の5月くらいにも生のHTML・CSS・JavaScriptで、まだ標準化される前だったFile System Access API(当時の名前はNative File System API)を使って似たようなサービスを作ったんですが、その頃はまだ動けば良いじゃん的なポリシーだったので、コードがまあまあ汚く、ファイル分けも雑だったのであんまり進んでメンテしたいプロジェクトではなくなっていました。まあそもそもGitHubとか初めて知ったくらいの時期だったのでベストプラクティスもクソもないvar使い放題で暗黙の型変換もしまくるようなプロジェクトだったので1年経ってちょっと成長した証として同じようなプロジェクト作ったという経緯もあります。</p>
<p>機能としては先述のローカルへの書き込み、読み出しの他に通常のダウンロードやFirestoreのDBへの保存にも対応してます。現在編集中のドキュメントもDBに記録されているので（正常に動いていれば）リロードしても続けて編集できるはずです。</p>
<h2>技術スタック</h2>
<p>基本的には全てFirebaseを使っています。認証はFirebase AuthenticationでGoogleとGitHubログイン、DBはFirestoreを使っています。本当は勉強のためにSQLとか使って、サーバーサイドもちゃんと書いてみたかったんですが、それやるほどの大規模アプリケーションでもないし、そもそもFirestoreの使い方も危うかったので地盤を固めるという意味で今回は全てFirebaseに頼りました。ルールは現状認証ユーザーのみ書き込めるようにしてますが、認証ユーザーを個別に認証するルールはまだ書いていないのでGitHubのREADMEの警告を消すまでは利用しないことをお勧めします。</p>
<p><a href="https://github.com/kota-yata/slouch">https://github.com/kota-yata/slouch</a></p>
<h2>おわりに</h2>
<p>特に新しいことは何もなかったのでZennとかには書きませんでしたが、次Webアプリ作るときはAWSを使います。誓います。</p>
<!-- HTML_TAG_END -->
  <div class="share svelte-hf3o4"><a class="share-twitter svelte-hf3o4" target="blank"><img alt="Twitter share button" src="/twitter.svg" width="25px" height="25px"></a>
    <a class="share-pocket svelte-hf3o4" target="blank"><img alt="Pocket share button" src="/pocket.svg" width="25px" height="25px"></a>
    <a class="share-instapaper svelte-hf3o4" target="blank"><img alt="InstaPaper share button" src="/instapaper.svg" width="25px"></a></div></div>
</div></main>

<footer class="svelte-gbfwkw">@ 2021 Kota Yatagai</footer>



			<script type="application/json" data-type="svelte-data" data-url="/posts/slouch.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"meta\":{\"title\":\"ローカルとクラウドのハイブリッド的なエディタ\",\"date\":\"2021-02-22\",\"category\":\"Programming\",\"description\":\"SvelteでMarkdownエディタ作ったよという話\",\"ogp\":\"\u002Fmedia\u002Fslouch.webp\"},\"body\":\"\u003Cp\u003E去年の8月ごろにSvelteを知って、それ以来ちまちまとWebサイト作ったりWebアプリ作ったりしてたんですが、NuxtとかReactやったことがないのもあって仮想DOMへの憧れが捨てられませんでした。というわけで、しばらくSvelteと距離を置くための最後の作品としてMarkdownエディタを作りました。\u003C\u002Fp\u003E\\n\u003Ch2\u003ESLOUCH\u003C\u002Fh2\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fslouch.dev\\\"\u003Ehttps:\u002F\u002Fslouch.dev\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EFirebaseのCloud Firestoreを使ってサーバーレスでDBをいじれるようにしつつ、ほとんどのブラウザに対応している\u003Ca href=\\\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FAPI\u002FFile_System_Access_API\\\"\u003EFile System Access API\u003C\u002Fa\u003Eを使ってローカルファイルの上書きと読み込みを実現しています。なので基本はサービス上でファイルを編集し、ローカルも一緒に書き換えたい！と思った時にワンクリックでできるという良さがあります。\u003C\u002Fp\u003E\\n\u003Cp\u003E僕個人の感覚としてあんまりネイティブアプリをいっぱい入れたくないというのがあって、なのでできる限りWeb上で、めっちゃ使う場合はPWA\u002Fネイティブアプリを入れる感じでPCの資源を節約したいわけです。そういう意味ではローカルファイルをWeb上でいじれるのはめちゃくちゃ嬉しいんですが、何せFile System Access APIは結構新しいAPIなので実装しているサービスがほとんどないんです。Webのマークダウンエディタの有名どころでいうと\u003Ca href=\\\"https:\u002F\u002Fstackedit.io\u002F\\\"\u003EStackEdit\u003C\u002Fa\u003EとかNotionとか（独自記法多すぎてMD感ないけど）が挙がると思うんですが、全部ローカルへのアクセスはダウンロードしかできないっつーのがどうも気に食わない。もう2021年なんだしローカルからのインポートができたって良いじゃないか…ということで自作しました。\u003C\u002Fp\u003E\\n\u003Cp\u003E実を言うと、去年の5月くらいにも生のHTML・CSS・JavaScriptで、まだ標準化される前だったFile System Access API(当時の名前はNative File System API)を使って似たようなサービスを作ったんですが、その頃はまだ動けば良いじゃん的なポリシーだったので、コードがまあまあ汚く、ファイル分けも雑だったのであんまり進んでメンテしたいプロジェクトではなくなっていました。まあそもそもGitHubとか初めて知ったくらいの時期だったのでベストプラクティスもクソもないvar使い放題で暗黙の型変換もしまくるようなプロジェクトだったので1年経ってちょっと成長した証として同じようなプロジェクト作ったという経緯もあります。\u003C\u002Fp\u003E\\n\u003Cp\u003E機能としては先述のローカルへの書き込み、読み出しの他に通常のダウンロードやFirestoreのDBへの保存にも対応してます。現在編集中のドキュメントもDBに記録されているので（正常に動いていれば）リロードしても続けて編集できるはずです。\u003C\u002Fp\u003E\\n\u003Ch2\u003E技術スタック\u003C\u002Fh2\u003E\\n\u003Cp\u003E基本的には全てFirebaseを使っています。認証はFirebase AuthenticationでGoogleとGitHubログイン、DBはFirestoreを使っています。本当は勉強のためにSQLとか使って、サーバーサイドもちゃんと書いてみたかったんですが、それやるほどの大規模アプリケーションでもないし、そもそもFirestoreの使い方も危うかったので地盤を固めるという意味で今回は全てFirebaseに頼りました。ルールは現状認証ユーザーのみ書き込めるようにしてますが、認証ユーザーを個別に認証するルールはまだ書いていないのでGitHubのREADMEの警告を消すまでは利用しないことをお勧めします。\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fkota-yata\u002Fslouch\\\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fkota-yata\u002Fslouch\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Ch2\u003Eおわりに\u003C\u002Fh2\u003E\\n\u003Cp\u003E特に新しいことは何もなかったのでZennとかには書きませんでしたが、次Webアプリ作るときはAWSを使います。誓います。\u003C\u002Fp\u003E\\n\"}"}</script>
		</div>
	</body>
</html>
