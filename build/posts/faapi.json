{"meta":{"title":"ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹","date":"2020-11-25","category":"Programming","description":"Font Access APIã§ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹","ogp":"/media/faapi.webp"},"body":"<p>Chrome87ã‚ˆã‚Šãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’èª¿ã¹ã‚‹Font Access APIãŒOrigin Trialsã«å…¬é–‹ã•ã‚Œã¾ã—ãŸã€‚æ­£ç›´ã“ã®APIã§ä½•ã‹ä½œã‚ã†ã¨ã¯æ€ã£ã¦ã„ã¾ã›ã‚“ãŒã€ã“ã®APIã‚’æ¬²ã™ã‚‹ã„ã¤ã®æ—¥ã‹ã®ãŸã‚ã«å°‘ã—èª¿ã¹ãŸã®ã§æ›¸ãæ®‹ã—ã¦ãŠãã¾ã™ã€‚</p>\n<div class=\"message\">\nå…ˆè¿°ã®é€šã‚Šã“ã®APIã¯Chrome87~ä»¥å¤–ã®ç’°å¢ƒä¸‹ã§ã¯å‹•ä½œã—ã¾ã›ã‚“ã€‚æœ¬ç•ªç’°å¢ƒã§ä½¿ã£ã¦æ€’ã‚‰ã‚Œã¦ã‚‚çŸ¥ã‚Šã¾ã›ã‚“\n</div>\n<h1>Quick Start</h1>\n<h2>Origin Trialsã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹</h2>\n<p>Origin Trialsã‚’åˆ©ç”¨ã—ãŸã“ã¨ãŒã‚ã‚‹æ–¹ã¯é£›ã°ã—ã¦å¤§ä¸ˆå¤«ã§ã™ã€‚<br>\nã¾ãšã¯<a href=\"chrome://flags/#font-access\">Chrome Flagsã®Font Access API</a>ã‚’enableã«å¤‰æ›´ã—ã¾ã™ã€‚ãã®å¾Œ<a href=\"https://developers.chrome.com/origintrials/#/view_trial/-7289075996899147775\">Origin Trialsãƒšãƒ¼ã‚¸ã®Local Font Access</a>ã‚’Registerã—ã¾ã™ã€‚ã™ã‚‹ã¨ãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚Œã¾ã™ã®ã§</p>\n<pre><code class=\"language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">meta</span> <span class=\"hljs-attr\">http-equiv</span>=<span class=\"hljs-string\">&quot;origin-trial&quot;</span> <span class=\"hljs-attr\">content</span>=<span class=\"hljs-string\">&quot;ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚‹&quot;</span>&gt;</span>\n</code></pre>\n<p>ã“ã®metaã‚¿ã‚°ã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æŒ¿å…¥ã—ã¾ã™ã€‚</p>\n<h2>APIãŒä½¿ãˆã‚‹ã‹ã©ã†ã‹</h2>\n<p>ã¾ãšã“ã®APIãŒä½¿ç”¨ã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-string\">&#x27;fonts&#x27;</span> <span class=\"hljs-keyword\">in</span> navigator) <span class=\"hljs-keyword\">return</span>;\n<span class=\"hljs-keyword\">const</span> status = <span class=\"hljs-keyword\">await</span> navigator.<span class=\"hljs-property\">permissions</span>.<span class=\"hljs-title function_\">query</span>({ <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&quot;font-access&quot;</span> });\n  <span class=\"hljs-keyword\">if</span> (status.<span class=\"hljs-property\">state</span> === <span class=\"hljs-string\">&quot;granted&quot;</span>)\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;permission was granted ğŸ‘&quot;</span>);\n  <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (status.<span class=\"hljs-property\">state</span> === <span class=\"hljs-string\">&quot;prompt&quot;</span>)\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;permission will be requested&quot;</span>);\n  <span class=\"hljs-keyword\">else</span>\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;permission was denied ğŸ‘&quot;</span>);\n</code></pre>\n<p>Chrome87ä»¥ä¸Šã§ã‚ã‚Œã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒãã†ã§ãªã„ãƒ–ãƒ©ã‚¦ã‚¶ã®å ´åˆã¯ä»–ã®å‡¦ç†ã§ä»£ç”¨ã™ã‚‹ã—ã‹ãªã„ã§ã—ã‚‡ã†ã€‚</p>\n<h2>ãƒ•ã‚©ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã™ã‚‹</h2>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">const</span> iterableFontObject = navigator.<span class=\"hljs-property\">fonts</span>.<span class=\"hljs-title function_\">query</span>();\n</code></pre>\n<p>ã“ã®å¤‰æ•°ã«ã¯éåŒæœŸã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿(<a href=\"https://ja.javascript.info/async-iterators-generators\">Asynchronous Iterator</a>)ãŒä»£å…¥ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Š<code>for await of</code>ã§ã‚¤ãƒ†ãƒ¬ãƒ¼ãƒˆå‡¦ç†ãŒã§ãã‚‹ã‚ã‘ã§ã™ã€‚</p>\n<h2>ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹</h2>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">await</span> (<span class=\"hljs-keyword\">const</span> metadata <span class=\"hljs-keyword\">of</span> iterableFontObject) {\n  <span class=\"hljs-keyword\">const</span> fontFamily = metadata.<span class=\"hljs-property\">family</span>; <span class=\"hljs-comment\">// e.g.ComicSansMS</span>\n  <span class=\"hljs-keyword\">const</span> postscriptName = metadata.<span class=\"hljs-property\">postscriptName</span>; <span class=\"hljs-comment\">// e.g.Comic Sans MS</span>\n  <span class=\"hljs-keyword\">const</span> fullName = metadata.<span class=\"hljs-property\">fullName</span>; <span class=\"hljs-comment\">// e.g.Comic Sans MS</span>\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(fontFamily, postscriptName, fullName);\n}\n</code></pre>\n<p>ç¾çŠ¶æ–‡å­—åˆ—ã¨ã—ã¦å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã“ã®3ã¤ã®ã‚ˆã†ã§ã™ã€‚postscriptNameã¯ç¢ºå®Ÿã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ã§ã€OpenTypeãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ãªãã¦ã‚‚UserAgentãŒã‚ˆã—ãªã«å°å‡ºã—ã¦ãã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚<br>\néåŒæœŸã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã¯<code>Object.keys().length</code>ã§ã¯ãƒ•ã‚©ãƒ³ãƒˆæ•°ã®ç®—å‡ºã¯ã§ããªã„ã®ã§ã€ã‚¤ãƒ†ãƒ¬ãƒ¼ãƒˆã¤ã„ã§ã«æ•°ãˆã¦ãŠãã®ãŒä¸€ç•ªæ‰‹ã£å–ã‚Šæ—©ã„ã‹ã¨ã€‚</p>\n<h1>SFNTãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹</h1>\n<p><code>blob()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚Œã°sfntã«ãƒ•ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚sfntãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ä½•ãŒå¬‰ã—ã„ã®ã‹ã¨ã„ã†ã¨ãƒ•ã‚©ãƒ³ãƒˆã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€PostScript, TrueType, OpenType, WOFFãªã©ãŒå¾—ã‚‰ã‚Œã‚‹ã¨ã„ã†ã‚ã‘ã§ã™ã€‚ã“ã‚Œã«é–¢ã—ã¦ã¯ã¾ã˜ã§ä½¿ã„é“ãŒåˆ†ã‹ã‚‰ã‚“ã€‚ã¨ã‚Šã‚ãˆãšå®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚</p>\n<h2>SFNTãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã™ã‚‹</h2>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">const</span> fonts = navigator.<span class=\"hljs-property\">fonts</span>.<span class=\"hljs-title function_\">query</span>();\n<span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">await</span> (<span class=\"hljs-keyword\">const</span> metadata <span class=\"hljs-keyword\">of</span> fonts) {\n  <span class=\"hljs-keyword\">const</span> sfnt = <span class=\"hljs-keyword\">await</span> metadata.<span class=\"hljs-title function_\">blob</span>();\n  <span class=\"hljs-keyword\">const</span> sfntVersion = (<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TextDecoder</span>).<span class=\"hljs-title function_\">decode</span>(\n    <span class=\"hljs-keyword\">await</span> sfnt.<span class=\"hljs-title function_\">slice</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">4</span>).<span class=\"hljs-title function_\">arrayBuffer</span>()\n  );\n}\n</code></pre>\n<p><code>blob()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã§Blobå‹ã®ãƒã‚¤ãƒŠãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚ã©ã†ã‚„ã‚‰ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ã€æœ€åˆã®4ãƒã‚¤ãƒˆã‚’å–å¾—ã™ã‚‹ã¨SFNTãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã§ãã‚‹ã‚‰ã—ã„ã§ã™ã€‚ã™ã’ãƒ¼ã€‚è©³ã—ãã¯<a href=\"https://docs.microsoft.com/en-us/typography/opentype/spec/otff#organization-of-an-opentype-font\">MSã®ä»•æ§˜æ›¸</a>ã‚’ã”è¦§ãã ã•ã„ã€‚</p>\n<p>ãŸã ã“ã®ã¾ã¾ã§ã¯ãªã‚“ã®ãƒ‡ãƒ¼ã‚¿ã‹åˆ†ã‹ã‚‰ãªã„ã®ã§æ‹¡å¼µå­å½¢å¼ã«å¤‰æ›ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">await</span> (<span class=\"hljs-keyword\">const</span> metadata <span class=\"hljs-keyword\">of</span> fonts) {\n  <span class=\"hljs-keyword\">let</span> outlineFormat = <span class=\"hljs-string\">&#x27;UNKNOWN&#x27;</span>;\n  <span class=\"hljs-keyword\">switch</span> (sfntVersion) {\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;\\x00\\x01\\x00\\x00&#x27;</span>:\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;true&#x27;</span>:\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;typ1&#x27;</span>:\n      outlineFormat = <span class=\"hljs-string\">&#x27;.ttf&#x27;</span>;\n      <span class=\"hljs-keyword\">break</span>;\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;OTTO&#x27;</span>:\n      outlineFormat = <span class=\"hljs-string\">&#x27;.cff&#x27;</span>;\n      <span class=\"hljs-keyword\">break</span>;\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;Format Extension:&#x27;</span>, outlineFormat, metadata.<span class=\"hljs-property\">family</span>);\n}\n</code></pre>\n<p>ç¾åœ¨Appleã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ³ãƒˆã¯TrueType(.ttf)ã‹Postscript(.cff)ã®ã©ã¡ã‚‰ã‹ãªã®ã§ã€ãã‚Œã«åˆã‚ã›ã¦SFNTãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çµã£ã¦ã„ãã¾ã™ã€‚ã“ã‚Œã¾ã˜ã§ä½•ã«ä½¿ã†ã‚“ã ã‚ã†ã‹ã€‚</p>\n<h1>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ‡¸å¿µã¨å¯¾ç­–</h1>\n<p>æœ€è¿‘<a href=\"https://zenn.dev/kota_yata/articles/6baecf59f0b3a39ea5a6\">File System Access API</a>ãªã©ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹APIãŒå¢—ãˆã¦ã„ã¾ã™ãŒã€ã‚„ã¯ã‚Šæ€–ã„ã®ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã§ã™ã€‚</p>\n<h2>ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆå¯¾ç­–</h2>\n<p>Font Access APIã¯å–å¾—ã—ãŸãƒ•ã‚©ãƒ³ãƒˆã‚’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã‚½ãƒ¼ãƒˆã—ã¦è¿”ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸé †ç•ªã®ã¾ã¾ãƒ•ã‚©ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã‚’è¿”ã—ã¦ã—ã¾ã†ã¨ã€ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã«åˆ©ç”¨ã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è­˜åˆ¥ã«ä½¿ã‚ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã‹ã‚‰ã§ã™ã€‚æ•°ç™¾ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å…¨ãåŒã˜é †ç•ªã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹è¤‡æ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã©ãã†ã„ãªã„ã§ã™ã‹ã‚‰ã­ã€‚</p>\n<h2>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ </h2>\n<p>æœ€åˆã®æ–¹ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®éƒ¨åˆ†ãŒã“ã‚Œã§ã™ã€‚ãƒ¡ã‚¿ã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ãªã„é™ã‚Šä½¿ç”¨ã§ããªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§APIã®æ¿«ç”¨ã‚’é˜²ã„ã§ã„ã¾ã™ã€‚<br>\n<a href=\"https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md\">https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md</a></p>\n<p>(ã“ã®è¨˜äº‹ã§ã‚‚å…ˆè¿°ã®File System Access APIãŒã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã¨ã—ã¦ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™)<br>\nãŸã ã€æœ€åˆã«ãƒ¡ã‚¿ã‚¿ã‚°ãªã—ã§ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ç¢ºèªã‚‚ãªã—ã§å®Ÿè¡Œã—ã¦ã¿ãŸã¨ã“ã‚æ™®é€šã«å‹•ã„ã¦ã—ã¾ã£ãŸã®ã§ã€ç­†è€…ã‚‚???ã¨ãªã£ã¦ã„ã‚‹ã¨ã“ã‚ã§ã™ã€‚</p>\n<h2>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å®Ÿè¡Œå‹•ä½œ</h2>\n<p>å®Ÿã¯ã“ã®APIã¯ä»Šã¾ã§ã®ã‚³ãƒ¼ãƒ‰ã‚’éåŒæœŸå³æ™‚é–¢æ•°ã«å…¥ã‚ŒãŸã ã‘ã§ã¯å‹•ãã¾ã›ã‚“ã€‚ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚‰è‡ªå‹•çš„ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã¨å¤§æŠµè‰¯ã„ã“ã¨ã¯ãªã„ã®ã§ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã€ä½•ã‹ã®ã‚­ãƒ¼ã‚’æ‰“ã¤ãªã©ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªã‚‰å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã—ã‹å‹•ã‹ãªã„ã‚ˆã†ãªä»•æ§˜ã«ãªã£ã¦ã„ã¾ã™ã€‚(e.g.<code>~.addEventListner()</code>)</p>\n<h2>ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®è¡¨ç¤º</h2>\n<p>ã“ã®APIã‚’å®Ÿè¡Œã™ã‚‹å‹•ä½œã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¡Œã†ã¨ã€<br>\n<img src=\"https://storage.googleapis.com/zenn-user-upload/m5dz76ntrrdeq4zio8x31iyt8xao\" alt=\"dialog\"><br>\nã“ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ä»–ã®ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹APIã§ã‚‚åŒæ§˜ã®ä»•æ§˜ã®ã‚‚ã®ãŒå¤šã„ã§ã™ã€‚</p>\n<h1>ãƒ‡ãƒ¢ã¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h1>\n<p>Chromeã®WebDevãƒãƒ¼ãƒ ãŒGlitchã«ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆã¨ã‚³ãƒ¼ãƒ‰ã‚’å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚</p>\n<p><a href=\"https://local-font-access.glitch.me/demo/\">https://local-font-access.glitch.me/demo/</a></p>\n<p>ã»ã¼ä¼¼ãŸã‚ˆã†ãªã‚‚ã®ã§ã™ãŒåƒ•ã®æ›¸ã„ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚æŠ•ã’ã¦ãŠãã¾ã™ã€‚</p>\n<h4>Quick Startã®æ–¹</h4>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">AccessFont</span> = <span class=\"hljs-keyword\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> status = <span class=\"hljs-keyword\">await</span> navigator.<span class=\"hljs-property\">permissions</span>.<span class=\"hljs-title function_\">query</span>({ <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&quot;font-access&quot;</span> });\n  <span class=\"hljs-keyword\">if</span> (status.<span class=\"hljs-property\">state</span> === <span class=\"hljs-string\">&quot;granted&quot;</span>){\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;permission was granted ğŸ‘&quot;</span>);\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (status.<span class=\"hljs-property\">state</span> === <span class=\"hljs-string\">&quot;prompt&quot;</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;permission will be requested&quot;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;permission was denied ğŸ‘&quot;</span>);\n  }\n  <span class=\"hljs-keyword\">const</span> iterableFontObject = navigator.<span class=\"hljs-property\">fonts</span>.<span class=\"hljs-title function_\">query</span>();\n  <span class=\"hljs-keyword\">let</span> total = <span class=\"hljs-number\">0</span>;\n  <span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">await</span> (<span class=\"hljs-keyword\">const</span> metadata <span class=\"hljs-keyword\">of</span> iterableFontObject) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(metadata.<span class=\"hljs-property\">fullName</span>);\n    total++;\n  }\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Total number of local fonts : <span class=\"hljs-subst\">${total}</span>`</span>);\n}\n<span class=\"hljs-keyword\">const</span> button = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;test&quot;</span>);\nbutton.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, <span class=\"hljs-title class_\">AccessFont</span>); <span class=\"hljs-comment\">// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹•ä½œãŒãªã„ã¨å‹•ã‹ã›ãªã„</span>\n</code></pre>\n<h4>SFNTã‚¢ã‚¯ã‚»ã‚¹ã®æ–¹</h4>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Access</span>SFNT = <span class=\"hljs-keyword\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> fonts = navigator.<span class=\"hljs-property\">fonts</span>.<span class=\"hljs-title function_\">query</span>();\n  <span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">await</span> (<span class=\"hljs-keyword\">const</span> metadata <span class=\"hljs-keyword\">of</span> fonts) {\n    <span class=\"hljs-keyword\">const</span> sfnt = <span class=\"hljs-keyword\">await</span> metadata.<span class=\"hljs-title function_\">blob</span>();\n    <span class=\"hljs-keyword\">const</span> sfntVersion = (<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TextDecoder</span>).<span class=\"hljs-title function_\">decode</span>(\n      <span class=\"hljs-keyword\">await</span> sfnt.<span class=\"hljs-title function_\">slice</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">4</span>).<span class=\"hljs-title function_\">arrayBuffer</span>()\n    );\n    <span class=\"hljs-keyword\">let</span> outlineFormat = <span class=\"hljs-string\">&#x27;UNKNOWN&#x27;</span>;\n    <span class=\"hljs-keyword\">switch</span> (sfntVersion) {\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;\\x00\\x01\\x00\\x00&#x27;</span>:\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;true&#x27;</span>:\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;typ1&#x27;</span>:\n        outlineFormat = <span class=\"hljs-string\">&#x27;.ttf&#x27;</span>;\n\t<span class=\"hljs-keyword\">break</span>;\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&#x27;OTTO&#x27;</span>:\n        outlineFormat = <span class=\"hljs-string\">&#x27;.cff&#x27;</span>;\n        <span class=\"hljs-keyword\">break</span>;\n    }\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;Format Extension:&#x27;</span>, outlineFormat, metadata.<span class=\"hljs-property\">family</span>);\n  }\n}\n<span class=\"hljs-keyword\">const</span> access = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;access&quot;</span>);\naccess.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, <span class=\"hljs-title class_\">Access</span>SFNT); <span class=\"hljs-comment\">// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹•ä½œãŒãªã„ã¨å‹•ã‹ã›ãªã„</span>\n</code></pre>\n<h1>çµ‚ã‚ã‚Šã«</h1>\n<p>æœ€åˆã«è¨˜äº‹ã‚’æ›¸ã„ãŸã¨ãã¯æœ¬æ°—ã§ä½•ã«ä½¿ã†ã®ã‹åˆ†ã‹ã‚‰ãªã„APIã§ã—ãŸãŒã€ã©ã†ã‚„ã‚‰Figmaã¨ã‹ãã®ä»–ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€CADã«ç‰¹åŒ–ã—ãŸãƒ•ã‚©ãƒ³ãƒˆã‚’Webã§ä½¿ã†éš›ã«å½¹ç«‹ã¤ã‚ˆã†ã§ã™ã€‚</p>\n<blockquote>\n<p>Bringing design apps like Figma, Gravit, and Photopea, to the web is great.<br>\nFor example, corporate logo fonts, or specialized fonts for CAD and other design applications.</p>\n</blockquote>\n<p><a href=\"https://developers.google.com/web/updates/2020/11/nic87#font-access\">https://developers.google.com/web/updates/2020/11/nic87#font-access</a></p>\n<h3>å‚è€ƒæ–‡çŒ®</h3>\n<p><a href=\"https://wicg.github.io/local-font-access/#current-language\">WICGä»•æ§˜æ›¸</a></p>\n<p><a href=\"https://web.dev/local-fonts/\">Web.devãƒãƒ¼ãƒ ãƒ–ãƒ­ã‚°(æœ€åˆã«èª­ã‚€ãªã‚‰ã“ã‚Œ)</a></p>\n<p><a href=\"https://glitch.com/~local-font-access\">Web.devãƒãƒ¼ãƒ Glitchãƒ‡ãƒ¢</a></p>\n<p><a href=\"https://developers.google.com/web/updates/2020/11/nic87\">Chrome87ã®æ–°æ©Ÿèƒ½ã¾ã¨ã‚(å…¬å¼)</a></p>\n<p><a href=\"https://www.chromestatus.com/feature/6234451761692672\">Chrome Platform Status</a></p>\n<p><a href=\"https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md\">APIã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã«é–¢ã™ã‚‹Chromeã®æ–‡çŒ®</a></p>\n<p><a href=\"https://nixeneko.hatenablog.com/entry/2018/06/20/000000\">https://nixeneko.hatenablog.com/entry/2018/06/20/000000</a></p>\n"}