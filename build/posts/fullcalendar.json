{"meta":{"title":"SvelteでFullCalendarを使う","date":"2020-09-23","category":"Programming","description":"今後Svelteの人気が上昇することを願って","ogp":"/media/fullcalendar.webp"},"body":"<p>そもそもSvelteって何なんという方は<a href=\"https://zenn.dev/toshitoma/articles/what-is-svelte\">こちら</a>を見ていただければ大体わかると思います。</p>\n<p>JavaScriptでは割と定番な(はず)のカレンダーライブラリ、<a href=\"https://fullcalendar.io/\">FullCalendar</a>。今年7月にv5もリリースされてコミュニティも活発なんですが、なぜかSvelteに対応していないという体たらく。<br>\nというわけで今回はNuxtより早いとか噂されておいて日本で全く知名度の上がらないSvelteでFull Calendarを使う方法をお伝えします。</p>\n<h3>サードパーティーのライブラリはあります。普通に</h3>\n<p>さも1からSvelteに対応させますみたいなタイトルですが、<a href=\"https://github.com/YogliB/svelte-fullcalendar\">Svelte用のFullCalendarライブラリ</a>はだいぶ前からあります。ただ、僕の観測範囲で日本語の文献(というか英語の文献も)が全く見当たらず、エラーが出たらGitHubで直接Issueを投げる以外の解決策がなかったので、これからSvelteでカレンダー機能を使いそうな人のために備忘録を残しておくまでです。</p>\n<h3>開発環境</h3>\n<p>開発環境で何かが変わるわけではありませんが一応。</p>\n<ul>\n<li>Mac OS BS 11.0 Beta</li>\n<li>VSCode Version: 1.49.1</li>\n<li>Google Chrome 85.0.4183.121（Official Build）</li>\n<li>ビルドツール : Rollup (WebPackの場合は参考にならないかも)</li>\n</ul>\n<h1>1章 環境構築</h1>\n<p>仰々しく1章とか書きましたが2章までしかないので安心してください。</p>\n<h3>yarn addしていく</h3>\n<pre><code>yarn add svelte-fullcalendar\n</code></pre>\n<p>まずはベースのモジュールを追加します。ただこれだけではクソも動かないのでカレンダーを表示するためのモジュールを追加していきます。</p>\n<pre><code>yarn add @fullcalendar/common @fullcalendar/core @fullcalendar/daygrid @fullcalendar/interaction\n</code></pre>\n<p>各パッケージについて説明します。</p>\n<ul>\n<li>@fullcalendar/common … このパッケージを追加しないと実質的に動作しません。</li>\n<li>@fullcalendar/core … このパッケージはベースとなるCSS、ローカライゼーションの際などに必要になります</li>\n<li>@fullcalendar/daygrid … 名前でわかると思いますがdaygridのパッケージです。<a href=\"https://fullcalendar.io/docs/list-view\">リストビュー</a>や<a href=\"https://fullcalendar.io/docs/timegrid-view\">タイムグリッド</a>を使いたい場合は各々追加する必要があります。</li>\n<li>@fullcalendar/interaction … このパッケージはクリックイベントなどイベントハンドラーを動作させるために必要です。</li>\n</ul>\n<p>svelte-fullcalendar以外のパッケージは純正のFullCalendarと同じものを追加するだけなのでハマることはなさそうですね。ハマったらごめんなさい</p>\n<h3>rollup.config.jsの変更</h3>\n<p>rollup.config.jsに以下を追加します。</p>\n<pre><code class=\"language-js\">...\n...\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n...\n  <span class=\"hljs-title function_\">resolve</span>({\n    <span class=\"hljs-attr\">browser</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-attr\">dedupe</span>: [<span class=\"hljs-string\">&#x27;svelte&#x27;</span>, <span class=\"hljs-string\">&#x27;@fullcalendar/common&#x27;</span>],\n  }),\n}\n</code></pre>\n<p>この解決策に辿り着くまで5時間くらい半ベソかきながらググってたのでこれは忘れずに追加してください。答えが見つかったissueが<a href=\"https://github.com/fullcalendar/fullcalendar/issues/5592#issuecomment-687671621\">こちら</a></p>\n<h1>2章 コードを書いていく</h1>\n<p>環境構築ができたらあとはコードをカキカキするだけ。カレンダーだけでComponentに分けてもよし、そんな女々しいことはせずApp.svelteに直書きする暴挙に出てもよし。</p>\n<h4>モジュールをimportしていく</h4>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">FullCalendar</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;svelte-fullcalendar&#x27;</span>;\n<span class=\"hljs-keyword\">import</span> interactionPlugin <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;@fullcalendar/interaction&#x27;</span>;\n<span class=\"hljs-keyword\">import</span> dayGridPlugin <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;@fullcalendar/daygrid&#x27;</span>;\n<span class=\"hljs-keyword\">import</span> jaLocal <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;@fullcalendar/core/locales/ja&#x27;</span>;\n</code></pre>\n<p>日本語対応する必要がなければjaLocalは必要ない。</p>\n<h4>CSSをimportしていく</h4>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">&#x27;@fullcalendar/core/main.min.css&#x27;</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">&#x27;@fullcalendar/daygrid/main.min.css&#x27;</span>;\n</code></pre>\n<p>上のCSSを追加しないとレイアウト崩れます。下はdaygrid使う場合のみ。</p>\n<h4>オプションを定義する</h4>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> options = {\n  <span class=\"hljs-attr\">droppable</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">editable</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">initialView</span>: <span class=\"hljs-string\">&#x27;dayGridMonth&#x27;</span>,\n  <span class=\"hljs-attr\">headerToolbar</span>: { <span class=\"hljs-attr\">left</span>: <span class=\"hljs-string\">&#x27;prevYear,prev,next,nextYear&#x27;</span>, <span class=\"hljs-attr\">center</span>: <span class=\"hljs-string\">&#x27;title&#x27;</span>, <span class=\"hljs-attr\">right</span>: <span class=\"hljs-string\">&#x27;today&#x27;</span> },\n  <span class=\"hljs-attr\">locale</span>: jaLocal,\n  <span class=\"hljs-attr\">buttonText</span>: { <span class=\"hljs-attr\">today</span>: <span class=\"hljs-string\">&#x27;今月に戻る&#x27;</span> },\n  <span class=\"hljs-attr\">plugins</span>: [dayGridPlugin, interactionPlugin],\n  <span class=\"hljs-attr\">dateClick</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">event</span>) =&gt;</span> <span class=\"hljs-title function_\">handleDateClick</span>(event),\n};\n<span class=\"hljs-comment\">// ドラッグイベントなどdateClick以外のJSイベントも普通に動きます</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">handleDateClick</span> = (<span class=\"hljs-params\">event</span>) =&gt; {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(event);\n};\n</code></pre>\n<p>ここは純正のFullCalendarのオプション表記とほぼ同じです。buttonText,initialViewなどv5で表現の変更されたフラッグもありますのでご注意ください。</p>\n<p><a href=\"https://fullcalendar.io/docs/upgrading-from-v4\">FullCalendar v5 Release Notes</a></p>\n<h4>表示するだけ</h4>\n<pre><code class=\"language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;Calendar&quot;</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">FullCalendar</span> {<span class=\"hljs-attr\">options</span>} /&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n</code></pre>\n<p>もちろん<code>options = {options}</code>と表記しても構いません。</p>\n<h2>動作確認</h2>\n<pre><code>yarn run dev\n</code></pre>\n<p><img src=\"https://storage.googleapis.com/zenn-user-upload/5s7cvv3bg4rgtc03jzwdte5y9crm\" alt=\"\"></p>\n<p>適当な日付をクリックすると…</p>\n<p><img src=\"https://storage.googleapis.com/zenn-user-upload/u35t0wcn58zw0opsvnb5xaw6xit3\" alt=\"\"></p>\n<p>よき。</p>\n<h1>終わりに</h1>\n<p>svelte-fullcalendarのリポジトリにサンプルも用意されていますのでそちらも参考になるかと思います。</p>\n<p><a href=\"https://www.dropbox.com/s/xtzcyry80hhmbcc/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202020-09-24%200.04.30.png?dl=0\">svelte-fullcalendar/examples/svelte</a></p>\n<p>まだまだ資料が少なくとっつきにくいSvelteですが、体感できるほどには高速なので一度試してると良いと思います。GitHubのIssueも飽和状態というわけではないので数日以内に返信来ると思います。</p>\n<h5>参考</h5>\n<p><a href=\"https://github.com/YogliB/svelte-fullcalendar\">svelte-fullcalendar</a><br>\n<a href=\"https://svelte.dev/repl/afa33232d6914c5f9fd25e332e167a7c?version=3.12.1\">svelte-fullcalendarがWeb上で試せるやつ</a><br>\n<a href=\"https://www.creative-tim.com/learning-lab/svelte/fullcalendar/argon-dashboard\">唯一見つけた英語のsvelte-fullcalendarの記事</a></p>\n"}